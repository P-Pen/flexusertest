import{o as s,c as m,w as o,u as e,b as c,g as p,i as f,f as n,h as i,a as l,n as w,t as h}from"./app-BYx064nO.js";import{i as I,c as k}from"./app-DISTCiac.js";import{_ as b}from"./app-BAIc7wsg.js";import{_ as x}from"./app-BKsB9XX9.js";import{_ as C}from"./app-C7gR9zYq.js";import{s as u,L as $}from"./app-Vf6It1y-.js";import{_}from"./app-DU3b6xa5.js";import{_ as G}from"./app-B-EzfWu7.js";import{_ as P}from"./app-B_zSIYIe.js";import{_ as g}from"./app-AqjyBPEM.js";import"./app-BXvxi6wb.js";import"./app-C9w-bzHc.js";import"./app-DyIe33QU.js";import"./app-5V9SnxW6.js";import"./app-DOaxShSm.js";import"./app-CxqGeHsb.js";import"./app-Dj8c2KwC.js";import"./app-cRxw2ZDj.js";import"./app-Ncl-Sitd.js";import"./app-DoTJvLi7.js";import"./app-DQhYsbJs.js";import"./app-BXiLqtxA.js";import"./app-CqvvE0jO.js";import"./app-CK9Tk_hc.js";import"./app-CAeEyuA3.js";import"./app-DoRtcMJm.js";import"./app-DPMEyUYH.js";import"./app-BZMTWmMM.js";import"./app-51hQc1Cd.js";import"./app-CqAVEB_b.js";import"./app-Cqxz9tud.js";import"./app-aIb4ksxL.js";import"./app-DYkSpHuE.js";import"./app-CiA1rHoH.js";import"./app-RbQF51V8.js";import"./app-tUtHmy3n.js";import"./app-DGM5HqRo.js";import"./app-DG0hMi2p.js";import"./app-CBq6-G9z.js";import"./app-DNadG4GC.js";import"./app-DR284fT9.js";function O(){const{utils:d,Tea:t}=I(this);this.enableGroup=function(a){this.$post("/servers/components/waf/updateGroupOn").params({groupId:a,isOn:1}).refresh()},this.disableGroup=function(a){this.$post("/servers/components/waf/updateGroupOn").params({groupId:a,isOn:0}).refresh()},this.deleteGroup=function(a){d.confirm("确定要删除此规则分组吗？",function(){this.$post("/servers/components/waf/deleteGroup").params({firewallPolicyId:this.firewallPolicyId,groupId:a}).refresh()})},this.createGroup=function(a){d.popup("/servers/components/waf/createGroupPopup?firewallPolicyId="+this.firewallPolicyId+"&type="+a,{callback:function(){d.success("保存成功",function(){d.reload()})}})},this.sortTable=function(a){this.$post("/servers/components/waf/sortGroups").params({firewallPolicyId:this.firewallPolicyId,type:this.type,groupIds:a}).success(function(){d.successToast("排序保存成功")})}}const T={key:0},S={key:1},B=["href"],N={key:0,class:"comment",style:{"padding-bottom":"0"}},V={class:"label-group mt-1"},D=["href"],L=["href"],R=["onClick"],z=["onClick"],E=["onClick"],M=l("p",{class:"comment flex items-center"},[n("所有规则匹配顺序为从上到下，可以拖动左侧的"),l("i",{class:"icon bars"}),n("排序。 ")],-1),j={key:1},Oe={__name:"groups",setup(d){const t=k(new O);return(a,y)=>(s(),m(b,{ctx:e(t)},{default:o(()=>[c(x,{ctx:e(t),"active-tab":e(t).type},null,8,["ctx","active-tab"]),e(t).featureIsOn?(s(),p("div",T,[c(P,null,{default:o(()=>[c(g,{onClick:y[0]||(y[0]=f(r=>e(t).createGroup(e(t).type),["prevent"])),"action-create":""},{default:o(()=>[n("添加分组")]),_:1})]),_:1}),e(t).groups.length==0?(s(),m(G,{key:0},{default:o(()=>[n("暂时还没有规则分组。")]),_:1})):i("",!0),e(t).groups.length>0?(s(),p("div",S,[c($,{items:e(t).groups,onSort:e(t).sortTable},{default:o(()=>[c(e(u),{rowReorder:"",headerStyle:"width: 3em"}),c(e(u),{header:"规则分组"},{body:o(({data:r})=>[l("a",{href:"/servers/server/settings/waf/group?serverId="+e(t).serverId+"&firewallPolicyId="+e(t).firewallPolicyId+"&type="+e(t).type+"&groupId="+r.id},[l("span",{class:w({disabled:!r.isOn})},h(r.name),3)],8,B),r.description.length>0?(s(),p("p",N,h(r.description),1)):i("",!0),l("p",V,[r.isOn?(s(),m(_,{key:0,class:"green"},{default:o(()=>[n("启用")]),_:1})):i("",!0),r.isOn?i("",!0):(s(),m(_,{key:1,class:"red"},{default:o(()=>[n("停用")]),_:1})),r.code.length>0?(s(),m(_,{key:2},{default:o(()=>[n("预置")]),_:1})):i("",!0),r.code.length==0?(s(),m(_,{key:3},{default:o(()=>[n("自定义")]),_:1})):i("",!0)])]),_:1}),c(e(u),{header:"规则集",headerClass:"text-center two wide",bodyClass:"text-center"},{body:o(({data:r})=>[l("a",{href:"/servers/server/settings/waf/group?serverId="+e(t).serverId+"&firewallPolicyId="+e(t).firewallPolicyId+"&type="+e(t).type+"&groupId="+r.id},h(r.countSets),9,D)]),_:1}),c(e(u),{header:"操作",headerClass:"three op"},{body:o(({data:r})=>[l("a",{href:"/servers/server/settings/waf/group?serverId="+e(t).serverId+"&firewallPolicyId="+e(t).firewallPolicyId+"&type="+e(t).type+"&groupId="+r.id},"详情",8,L),n("   "),r.isOn?i("",!0):(s(),p("a",{key:0,href:"",onClick:f(v=>e(t).enableGroup(r.id),["prevent"])},"启用",8,R)),r.isOn?(s(),p("a",{key:1,href:"",onClick:f(v=>e(t).disableGroup(r.id),["prevent"])},"停用",8,z)):i("",!0),n("   "),r.canDelete?(s(),p("a",{key:2,href:"",onClick:f(v=>e(t).deleteGroup(r.id),["prevent"])},"删除",8,E)):i("",!0)]),_:1})]),_:1},8,["items","onSort"]),M])):i("",!0)])):i("",!0),e(t).featureIsOn?i("",!0):(s(),p("div",j,[c(C)]))]),_:1},8,["ctx"]))}};export{Oe as default};
