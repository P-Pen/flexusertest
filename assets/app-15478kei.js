import{i as k,c as I}from"./app-DISTCiac.js";import{e as w}from"./app-DUeSaIYz.js";import{_ as L,a as b}from"./app-BuHt2kYS.js";import{T as N}from"./app-DR284fT9.js";import{_ as z}from"./app-diI1Q6nu.js";import{C as V}from"./app-CnNkgeR8.js";import{C as v}from"./app-D2_aZ1I5.js";import{C as S}from"./app-DzOFJRH2.js";import{o as g,g as C,a,u as c,b as h,w as u,h as $,F as D,f as d,D as E,c as A,t as m,ae as M}from"./app-BYx064nO.js";import"./app-51hQc1Cd.js";import"./app-CqAVEB_b.js";import"./app-CK9Tk_hc.js";import"./app-Cqxz9tud.js";import"./app-DoRtcMJm.js";import"./app-aIb4ksxL.js";import"./app-DYkSpHuE.js";import"./app-DyIe33QU.js";function U(){const{utils:i}=k(this);i.setEcharts(w),this.$delay(function(){let t=this;this.totalDailyStats=this.logDailyStats.map(function(o,s){return{day:o.day,count:t.logDailyStats[s].count+t.blockDailyStats[s].count+t.captchaDailyStats[s].count}});let l=this.processMaxUnit(this.totalDailyStats);this.reloadLineChart("daily-chart","规则分组",this.totalDailyStats,function(o){return o.day.substring(4,6)+"-"+o.day.substring(6)},function(o){return t.logDailyStats[o.dataIndex].day.substring(4,6)+"-"+t.logDailyStats[o.dataIndex].day.substring(6)+": 拦截: "+i.formatNumber(t.blockDailyStats[o.dataIndex].count)+", 验证码: "+i.formatNumber(t.captchaDailyStats[o.dataIndex].count)+", 记录: "+i.formatNumber(t.logDailyStats[o.dataIndex].count)},l);let e=this.processMaxUnit(this.groupStats),n=this.groupStats.$sum(function(o,s){return s.rawCount});this.reloadBarChart("group-chart","规则分组",this.groupStats,function(o){return o.group.name},function(o){let s="";return n>0&&(s=", 占比: "+Math.round(t.groupStats[o.dataIndex].rawCount*100*100/n)/100+"%"),t.groupStats[o.dataIndex].group.name+": "+i.formatNumber(t.groupStats[o.dataIndex].rawCount)+s},e),window.addEventListener("resize",function(){t.resizeChart("daily-chart"),t.resizeChart("group-chart")})}),this.reloadLineChart=function(t,l,e,n,o,s){let p=document.getElementById(t);if(p==null)return;let f=this,y={xAxis:{data:e.map(n),axisLabel:{color:i.chartLabelColor}},yAxis:{axisLabel:{formatter:function(r){return r+s},color:i.chartLabelColor}},tooltip:{show:!0,trigger:"item",formatter:o},grid:{left:40,top:10,right:20,bottom:20},series:[{name:l,type:"line",data:this.totalDailyStats.map(function(r,_){return f.totalDailyStats[_].count}),areaStyle:{},itemStyle:{color:i.DefaultChartColor}},{name:l,type:"line",data:this.logDailyStats.map(function(r){return r.count}),itemStyle:{color:"#879BD7"}},{name:l,type:"line",data:this.blockDailyStats.map(function(r){return r.count}),itemStyle:{color:"#F39494"}},{name:l,type:"line",data:this.captchaDailyStats.map(function(r){return r.count}),itemStyle:{color:"#FBD88A"}}],animation:!0};i.initChart(p,void 0,r=>{r.setOption(y),r.resize()})},this.reloadBarChart=function(t,l,e,n,o,s){let p=document.getElementById(t);p!=null&&i.initChart(p,void 0,f=>{let y=20,r=0;const _=i.xRotation(f,e.map(n));_!=null&&(y=_[0],r=_[1]);let B={xAxis:{data:e.map(n),axisLabel:{interval:0,color:i.chartLabelColor,rotate:r}},yAxis:{axisLabel:{formatter:function(x){return x+s},color:i.chartLabelColor}},tooltip:{show:!0,trigger:"item",formatter:o},grid:{left:40,top:10,right:20,bottom:y},series:[{name:l,type:"bar",data:e.map(function(x){return x.count}),itemStyle:{color:i.DefaultChartColor},barWidth:"10em"}],animation:!0};f.setOption(B),f.resize()})},this.resizeChart=function(t){let l=document.getElementById(t);l!=null&&i.initChart(l,void 0,e=>{e.resize()})},this.processMaxUnit=function(t){let l=t.$map(function(o,s){return s.count}).$max(),e=0,n="";return l>=1e3*1e3*1e3?(n="B",e=1e3*1e3*1e3):l>=1e3*1e3?(n="M",e=1e3*1e3):l>=1e3&&(n="K",e=1e3),t.forEach(function(o){o.rawCount=o.count,e>0&&(o.count/=e)}),n}}const F=["action"],R={class:"fields inline"},T={key:0},O={class:"ui column"},W=a("h5",null,"今日拦截",-1),K={class:"value"},j={class:"ui column"},q=a("h5",null,"今日验证码验证",-1),G={class:"value"},H={class:"ui column"},J=a("h5",null,"今日记录",-1),P={class:"value"},Q={class:"ui column"},X=a("h5",null,"本周拦截",-1),Y={class:"value"},Z={class:"ui column"},tt=a("h5",null,"本月拦截",-1),at={class:"value"},ot=a("span",{class:"color-span",style:{background:"#F39494"}},"拦截",-1),et=a("span",{class:"color-span",style:{background:"#FBD88A"}},"验证码",-1),nt=a("span",{class:"color-span",style:{background:"#879BD7"}},"记录",-1),it=a("div",{class:"chart-box",id:"daily-chart"},null,-1),lt=a("div",{class:"chart-box",id:"group-chart"},null,-1),Dt={__name:"index",setup(i){const t=I(new U);return(l,e)=>(g(),C(D,null,[a("form",{method:"get",action:c(t).path,autocomplete:"off"},[a("div",R,[c(t).servers.length>0?(g(),C("div",T,[h(L,{name:"serverId",modelValue:c(t).serverId,"onUpdate:modelValue":e[0]||(e[0]=n=>c(t).serverId=n)},{default:u(()=>[h(b,{value:"0"},{default:u(()=>[d("[选择域名]")]),_:1}),(g(!0),C(D,null,E(c(t).servers,n=>(g(),A(b,{value:n.id},{default:u(()=>[d(m(n.serverName),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])])):$("",!0),a("div",null,[h(N,{secondary:"",type:"submit"},{default:u(()=>[d("查找")]),_:1})])])],8,F),h(z,null,{default:u(()=>[a("div",O,[W,a("div",K,[a("span",null,m(c(t).countDailyBlock),1),d("次")])]),a("div",j,[q,a("div",G,[a("span",null,m(c(t).countDailyCaptcha),1),d("次")])]),a("div",H,[J,a("div",P,[a("span",null,m(c(t).countDailyLog),1),d("次")])]),a("div",Q,[X,a("div",Y,[a("span",null,m(c(t).countWeeklyBlock),1),d("次")])]),a("div",Z,[tt,a("div",at,[a("span",null,m(c(t).countMonthlyBlock),1),d("次")])])]),_:1}),h(V,null,{default:u(()=>[h(v,{cols:"1"},{header:u(()=>[d("近15日趋势 "),a("span",{class:"color-span",style:M("background: "+c(t).$utils.DefaultChartColor)},"全部",4),ot,et,nt]),default:u(()=>[h(S,null,{value:u(()=>[it]),_:1})]),_:1}),h(v,{cols:"1"},{header:u(()=>[d("拦截类型分布")]),default:u(()=>[h(S,null,{value:u(()=>[lt]),_:1})]),_:1})]),_:1})],64))}};export{Dt as default};
