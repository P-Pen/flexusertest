import{r as g,o as i,g as l,b as h,w as f,ae as E,u as n,bb as I,c as $,a as c,i as x,h as v,_ as A,D as _,n as V,f as w,t as C,F as p,L as T,d as b,e as B,M as U,N as P}from"./app-BYx064nO.js";import{P as R}from"./app-BnDFQ2zy.js";import{i as D,c as L}from"./app-DISTCiac.js";import{T as F}from"./app-DR284fT9.js";import{_ as M}from"./app--BlRpVz_.js";import{_ as K}from"./app-C5GVF480.js";import{a as W,T as z}from"./app-DRGtcCVV.js";import"./app-GoR2fTOd.js";import"./app-tUtHmy3n.js";import"./app-CK9Tk_hc.js";import"./app-DYkSpHuE.js";function O(){const{utils:d}=D(this);var r="常用";this.letterGroups=[{code:r,count:0,countMatched:0},{code:"ABC",count:0,countMatched:0},{code:"DEF",count:0,countMatched:0},{code:"GHI",count:0,countMatched:0},{code:"JKL",count:0,countMatched:0},{code:"MNO",count:0,countMatched:0},{code:"PQR",count:0,countMatched:0},{code:"STU",count:0,countMatched:0},{code:"VWX",count:0,countMatched:0},{code:"YZ",count:0,countMatched:0}],this.commonGroupName=r,this.selectedGroup=r,this.letterCountries={};let e=this;this.countSelectedCountries=this.countries.$count(function(t,o){return o.isChecked}),this.countries.forEach(function(t){typeof e.letterCountries[t.letter]>"u"&&(e.letterCountries[t.letter]=[]),e.letterCountries[t.letter].push(t),t.isCommon&&(typeof e.letterCountries[r]>"u"&&(e.letterCountries[r]=[]),e.letterCountries[r].push(t))}),this.isCheckingAll=!1,this.$delay(function(){this.change()}),this.checkAll=function(){this.countries.forEach(function(t){t.isChecked=e.isCheckingAll}),this.change()},this.selectGroup=function(t){this.selectedGroup=t.code},this.selectCountry=function(t){this.change()},this.deselectCountry=function(t){t.isChecked=!1,this.change()},this.change=function(){let t=this;this.letterGroups.forEach(function(o){o.count=0,o.countMatched=0}),this.countries.forEach(function(o){t.letterGroups.forEach(function(s){(s.code.indexOf(o.letter)>=0||s.code==r&&o.isCommon)&&(o.isChecked&&s.count++,t.matchCountry(o)?(o.isMatched=t.keyword.length>0,s.countMatched++):o.isMatched=!1)})})},this.submit=function(){let t=[];this.countries.forEach(function(o){o.isChecked&&t.push(o)}),this.$NotifyPopup({code:200,data:{selectedCountries:t}})},this.searchBoxVisible=!1,this.keyword="",this.showSearchBox=function(){this.searchBoxVisible=!0,this.$delay(function(){this.$refs.searchBox.focus()})},this.changeKeyword=function(t){this.keyword=t.value.trim(),this.change()},this.matchCountry=function(t){if(this.keyword.length==0||d.match(t.name,this.keyword))return!0;if(t.pinyin!=null&&t.pinyin.length>0){let o=!1,s=this;if(t.pinyin.forEach(function(a){d.match(a,s.keyword)&&(o=!0)}),o)return!0}if(t.codes!=null&&t.codes.length>0){let o=!1,s=this;if(t.codes.forEach(function(a){d.match(a,s.keyword)&&(o=!0)}),o)return!0}return!1}}const H=c("i",{class:"icon remove"},null,-1),J=[H],Q={__name:"SearchBox",props:["placeholder","width"],emits:["input","change"],setup(d,{expose:r,emit:e}){const t=d,o=g(),s=e,{realWidth:a,realValue:u}=function(){let k=t.width;return k==null&&(k="14em"),{realWidth:g(k),realValue:g("")}}(),m=function(){s("input",{value:u.value}),s("change",{value:u.value})},S=function(){u.value="",G(),m()},G=function(){o.value.focus()};return r({focus:G}),(k,y)=>(i(),l("div",null,[h(z,null,{default:f(()=>[h(K,{type:"text",placeholder:d.placeholder,style:E({width:n(a)}),onInput:m,modelValue:n(u),"onUpdate:modelValue":y[0]||(y[0]=N=>I(u)?u.value=N:null),ref_key:"valueRef",ref:o},null,8,["placeholder","style","modelValue"]),n(u).length>0?(i(),$(W,{key:0},{default:f(()=>[c("a",{href:"",onClick:x(S,["prevent"])},J)]),_:1})):v("",!0)]),_:1})]))}},X=d=>(U("data-v-4758cabe"),d=d(),P(),d),Y={key:0},Z={key:1},j={class:"relative"},q={class:"flex flex-wrap gap-4 mr-20"},ee=["onClick"],te={key:0,class:"count"},oe={class:"absolute right-1 top-0.5"},se={class:"mt-4"},ne={key:0},ie={class:"grid grid-cols-4 gap-3.5"},ce={key:1},le={key:0,class:"country-group"},ae={class:"grid grid-cols-4 gap-2"},ue={class:"mt-4 relative"},re={class:"absolute right-1 top-2"},de=X(()=>c("i",{class:"icon search"},null,-1)),he=[de],fe={class:"absolute right-1 top-2"},pe={__name:"selectCountriesPopup",setup(d){const r=g(),e=L(new O,{refs:{searchBox:r}});return(t,o)=>(i(),$(R,null,{default:f(()=>[n(e).type=="allow"?(i(),l("header",Y,"选择允许的区域")):v("",!0),n(e).type=="deny"?(i(),l("header",Z,"选择封禁的区域")):v("",!0),c("form",null,[c("div",j,[c("div",q,[(i(!0),l(p,null,_(n(e).letterGroups,s=>(i(),l("a",{class:V(["menu-item",{active:s.code==n(e).selectedGroup,disabled:s.countMatched==0}]),href:"",onClick:x(a=>n(e).selectGroup(s),["prevent"])},[w(C(s.code),1),s.count>0?(i(),l("span",te," ("+C(s.count)+")",1)):v("",!0)],10,ee))),256))]),c("div",oe,[h(M,{modelValue:n(e).isCheckingAll,"onUpdate:modelValue":o[0]||(o[0]=s=>n(e).isCheckingAll=s),onChange:n(e).checkAll},{default:f(()=>[w("全选")]),_:1},8,["modelValue","onChange"])]),h(T)]),c("div",se,[(i(!0),l(p,null,_(n(e).letterGroups,s=>(i(),l("div",null,[s.code==n(e).commonGroupName&&s.code==n(e).selectedGroup?(i(),l("div",ne,[c("div",ie,[(i(!0),l(p,null,_(n(e).letterCountries[n(e).commonGroupName],a=>(i(),l("div",null,[h(M,{modelValue:a.isChecked,"onUpdate:modelValue":u=>a.isChecked=u,onChange:u=>n(e).selectCountry(a)},{default:f(()=>[c("span",{class:V({blue:a.isMatched})},C(a.name),3)]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]))),256))])])):(i(),l("div",ce,[(i(!0),l(p,null,_(s.code,a=>(i(),l(p,null,[n(e).letterCountries[a]!=null&&s.code==n(e).selectedGroup?(i(),l("div",le,[c("h5",null,C(a),1),c("div",ae,[(i(!0),l(p,null,_(n(e).letterCountries[a],u=>(i(),l("div",null,[h(M,{modelValue:u.isChecked,"onUpdate:modelValue":m=>u.isChecked=m,onChange:m=>n(e).selectCountry(u)},{default:f(()=>[c("span",{class:V({blue:u.isMatched})},C(u.name),3)]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]))),256))])])):v("",!0)],64))),256))]))]))),256))]),c("div",ue,[c("div",null,[h(F,{onClick:x(n(e).submit,["prevent"])},{default:f(()=>[w("确定")]),_:1},8,["onClick"])]),b(c("div",re,[c("a",{href:"",onClick:o[1]||(o[1]=x((...s)=>n(e).showSearchBox&&n(e).showSearchBox(...s),["prevent"]))},he)],512),[[B,!n(e).searchBoxVisible]]),b(c("div",fe,[h(Q,{placeholder:"关键词",ref_key:"searchBox",ref:r,onChange:n(e).changeKeyword},null,8,["onChange"])],512),[[B,n(e).searchBoxVisible]])])])]),_:1}))}},ye=A(pe,[["__scopeId","data-v-4758cabe"]]);export{ye as default};
