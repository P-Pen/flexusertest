import{P as k}from"./app-BnDFQ2zy.js";import{i as b,c as I}from"./app-DISTCiac.js";import{a as w,_ as v}from"./app-Dj8c2KwC.js";import{T as g}from"./app-DoTJvLi7.js";import{_ as q}from"./app-CeIVDo0K.js";import{D as f}from"./app-D0jdtzyy.js";import{o,c as L,w as u,b as d,f as a,u as s,g as n,a as t,t as l,n as A,h as i,F as _,D as h}from"./app-BYx064nO.js";import"./app-GoR2fTOd.js";import"./app-cRxw2ZDj.js";import"./app-DOaxShSm.js";function S(){const{utils:p}=b(this);if(this.tab="summary",this.utils=p,this.switchTab=function(e){this.tab=e},this.requestHeaders=[],this.accessLog.header!=null)for(let e in this.accessLog.header){let c=this.accessLog.header[e];typeof c=="object"&&this.requestHeaders.push({name:e,values:c.values,isGeneral:!e.startsWith("X-")})}if(this.requestHeaders.sort(function(e,c){return e.name<c.name?-1:1}),this.responseHeaders=[],this.accessLog.sentHeader!=null)for(let e in this.accessLog.sentHeader){let c=this.accessLog.sentHeader[e];typeof c=="object"&&this.responseHeaders.push({name:e,values:c.values,isGeneral:!e.startsWith("X-")})}if(this.responseHeaders.sort(function(e,c){return e.name<c.name?-1:1}),this.cookies=[],this.accessLog.cookie!=null)for(let e in this.accessLog.cookie){let c=this.accessLog.cookie[e];typeof c=="string"&&this.cookies.push({name:e,value:c})}this.cookies.sort(function(e,c){return e.name.startsWith("_")?c.name.startsWith("_")?e.name<c.name?-1:1:-1:c.name.startsWith("_")?1:e.name.toUpperCase()<c.name.toUpperCase()?-1:1})}const R=t("header",null,"访问日志详情",-1),H={key:0},T={class:"ui table selectable small celled"},C={style:{width:"50%"}},P=t("em",null,"(Request)",-1),x=t("em",null,"(RequestMethod)",-1),B=t("em",null,"(RequestURI)",-1),U=t("em",null,"(Host)",-1),W=t("em",null,"(RemoteAddr:RemotePort)",-1),V=t("em",null,"(Referer)",-1),G={key:0},D={key:1,class:"disabled"},F=t("em",null,"(UserAgent)",-1),M={key:0},N={key:1,class:"disabled"},$=t("em",null,"(StatusMessage)",-1),j={key:0,class:"grey small"},O=t("em",null,"(ContentType)",-1),X={key:0},z={key:1,class:"disabled"},E=t("em",null,"(BytesSent)",-1),J={key:0},K={key:0,class:"grey small"},Q={key:1,class:"disabled"},Y={key:0},Z={key:1,class:"disabled"},ee=t("em",null,"(TimeLocal)",-1),se={key:0},te={class:"color-border"},oe={key:0},ne={key:1},le={key:1},ae={class:"color-border"},ce=["href"],re=["href"],ie=t("td",null,null,-1),ue={key:2},de={colspan:"2"},_e={class:"red"},he={key:1},ge=t("td",{class:"title"},"Status",-1),fe={class:"title"},me={key:0},pe={key:1,style:{"font-style":"italic"}},ye={key:2},Le={class:"title"},ke={key:0},be={key:1,style:{"font-style":"italic"}},Ie={key:0},we=t("tr",null,[t("td",{colspan:"2"},"请求内容：")],-1),ve={colspan:"2"},qe={key:3},Ae={key:0,class:"comment"},Se={key:1},Re={class:"title"},He={key:4},Te=t("td",{class:"title"},[a("综合信息"),t("em",null,"(UserAgent)")],-1),Ce={key:0},Pe={key:1,class:"disabled"},xe=t("td",null,"IP",-1),Be={key:0},Ue=t("td",null,"区域",-1),We={key:1},Ve=t("td",null,"ISP",-1),Ee={__name:"viewPopup",setup(p){const e=I(new S);return(c,y)=>(o(),L(k,null,{default:u(()=>[R,d(v,{modelValue:s(e).tab,"onUpdate:modelValue":y[0]||(y[0]=r=>s(e).tab=r),class:"mb-4"},{default:u(()=>[d(w,null,{default:u(()=>[d(g,{code:"summary"},{default:u(()=>[a("综合信息")]),_:1}),d(g,{code:"response"},{default:u(()=>[a("响应数据（Response）")]),_:1}),d(g,{code:"request"},{default:u(()=>[a("请求数据（Request）")]),_:1}),d(g,{code:"cookie"},{default:u(()=>[a("Cookie")]),_:1}),d(g,{code:"client"},{default:u(()=>[a("终端信息")]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(e).tab=="summary"?(o(),n("div",H,[t("table",T,[t("tr",null,[t("td",C,[a("请求概要"),P,a("："+l(s(e).accessLog.request),1)]),t("td",null,"请求ID："+l(s(e).accessLog.requestId),1)]),t("tr",null,[t("td",null,[a("请求方法"),x,a("："+l(s(e).accessLog.requestMethod),1)]),t("td",null,[a("请求URI"),B,a("："+l(s(e).accessLog.requestURI),1)])]),t("tr",null,[t("td",null,[a("主机地址"),U,a("："+l(s(e).accessLog.host),1)]),t("td",null,[a("终端地址"),W,a("："+l(s(e).accessLog.remoteAddr)+":"+l(s(e).accessLog.remotePort),1)])]),t("tr",null,[t("td",null,[a("请求来源"),V,a("： "),s(e).accessLog.referer!=null&&s(e).accessLog.referer.length>0?(o(),n("span",G,l(s(e).accessLog.referer),1)):(o(),n("span",D,"没有设置"))]),t("td",null,[a("终端信息"),F,a("： "),s(e).accessLog.userAgent!=null&&s(e).accessLog.userAgent.length>0?(o(),n("span",M,l(s(e).accessLog.userAgent),1)):(o(),n("span",N,"没有设置"))])]),t("tr",null,[t("td",null,[a("状态"),$,a("："),t("span",{class:A({red:s(e).accessLog.status>=400,green:s(e).accessLog.status<400})},[a(l(s(e).accessLog.status)+" "+l(s(e).accessLog.statusMessage)+" ",1),s(e).accessLog.originStatus>=400||s(e).accessLog.originStatus>0&&s(e).accessLog.originStatus!=s(e).accessLog.status?(o(),n("span",j,"（源站"+l(s(e).accessLog.originStatus)+"）",1)):i("",!0)],2)]),t("td",null,[a("文件类型"),O,a("： "),s(e).accessLog.contentType!=null&&s(e).accessLog.contentType.length>0?(o(),n("span",X,l(s(e).accessLog.contentType),1)):(o(),n("span",z,"没有设置"))])]),t("tr",null,[t("td",null,[a("下行流量"),E,a("： "),s(e).accessLog.bytesSent!=null?(o(),n("span",J,[a(l(s(e).accessLog.bytesSent)+" ",1),s(e).accessLog.bytesSent>0?(o(),n("span",K,"（"+l(s(e).utils.formatBytes(s(e).accessLog.bytesSent))+"）",1)):i("",!0)])):(o(),n("span",Q,"0"))]),t("td",null,[a("源站地址： "),s(e).accessLog.originAddress!=null&&s(e).accessLog.originAddress?(o(),n("span",Y,l(s(e).accessLog.originAddress),1)):(o(),n("span",Z,"未访问源站"))])]),t("tr",null,[t("td",null,"ISO8601时间："+l(s(e).accessLog.timeISO8601),1),t("td",null,[a("本地时间"),ee,a("："+l(s(e).accessLog.timeLocal),1)])]),s(e).wafInfo!=null?(o(),n("tr",se,[t("td",te,"WAF策略："+l(s(e).wafInfo.policy.name),1),t("td",null,[a("WAF规则分组： "),s(e).wafInfo.group!=null?(o(),n("span",oe,l(s(e).wafInfo.group.name),1)):(o(),n("span",ne,"-"))])])):i("",!0),s(e).wafInfo!=null&&s(e).wafInfo.set!=null?(o(),n("tr",le,[t("td",ae,[a("WAF规则集： "),s(e).wafInfo.policy.serverId==0?(o(),n("a",{key:0,href:"/servers/components/waf/group?firewallPolicyId="+s(e).accessLog.firewallPolicyId+"&type=inbound&groupId="+s(e).accessLog.firewallRuleGroupId+"#set"+s(e).accessLog.firewallRuleSetId,target:"_parent"},l(s(e).wafInfo.set.name),9,ce)):i("",!0),s(e).wafInfo.policy.serverId>0?(o(),n("a",{key:1,href:"/servers/server/settings/waf/group?serverId="+s(e).accessLog.serverId+"&firewallPolicyId="+s(e).accessLog.firewallPolicyId+"&type=inbound&groupId="+s(e).accessLog.firewallRuleGroupId+"#set"+s(e).accessLog.firewallRuleSetId,target:"_parent"},l(s(e).wafInfo.set.name),9,re)):i("",!0)]),ie])):i("",!0),s(e).accessLog.errors!=null&&s(e).accessLog.errors.length>0?(o(),n("tr",ue,[t("td",de,[(o(!0),n(_,null,h(s(e).accessLog.errors,r=>(o(),n("div",null,[t("pre",null,[t("span",_e,l(r),1)])]))),256))])])):i("",!0)])])):i("",!0),s(e).tab=="response"?(o(),n("div",he,[d(f,{class:"small"},{default:u(()=>[t("tbody",null,[t("tr",null,[ge,t("td",null,l(s(e).accessLog.status)+" "+l(s(e).accessLog.statusMessage),1)])])]),_:1}),s(e).responseHeaders.length>0?(o(),L(f,{key:0,class:"small"},{default:u(()=>[(o(!0),n(_,null,h(s(e).responseHeaders,r=>(o(),n("tbody",null,[(o(!0),n(_,null,h(r.values,m=>(o(),n("tr",null,[t("td",fe,[r.isGeneral?(o(),n("span",me,l(r.name),1)):(o(),n("span",pe,l(r.name),1))]),t("td",null,l(m),1)]))),256))]))),256))]),_:1})):i("",!0)])):i("",!0),s(e).tab=="request"?(o(),n("div",ye,[d(f,{class:"small"},{default:u(()=>[(o(!0),n(_,null,h(s(e).requestHeaders,r=>(o(),n("tbody",null,[(o(!0),n(_,null,h(r.values,m=>(o(),n("tr",null,[t("td",Le,[r.isGeneral?(o(),n("span",ke,l(r.name),1)):(o(),n("span",be,l(r.name),1))]),t("td",null,l(m),1)]))),256))]))),256)),s(e).requestBody.length>0?(o(),n("tbody",Ie,[we,t("tr",null,[t("td",ve,[d(q,{type:s(e).requestContentType},{default:u(()=>[a(l(s(e).requestBody),1)]),_:1},8,["type"])])])])):i("",!0)]),_:1})])):i("",!0),s(e).tab=="cookie"?(o(),n("div",qe,[s(e).cookies.length==0?(o(),n("p",Ae,"暂时没有Cookie数据。")):(o(),n("div",Se,[d(f,{class:"small"},{default:u(()=>[t("tbody",null,[(o(!0),n(_,null,h(s(e).cookies,r=>(o(),n("tr",null,[t("td",Re,l(r.name),1),t("td",null,l(r.value),1)]))),256))])]),_:1})]))])):i("",!0),s(e).tab=="client"?(o(),n("div",He,[d(f,{class:"small"},{default:u(()=>[t("tbody",null,[t("tr",null,[Te,t("td",null,[s(e).accessLog.userAgent!=null&&s(e).accessLog.userAgent.length>0?(o(),n("span",Ce,l(s(e).accessLog.userAgent),1)):(o(),n("span",Pe,"没有设置"))])]),t("tr",null,[xe,t("td",null,l(s(e).accessLog.remoteAddr),1)]),s(e).region!=null&&s(e).region.full!=null&&s(e).region.full.length>0?(o(),n("tr",Be,[Ue,t("td",null,l(s(e).region.full),1)])):i("",!0),s(e).region!=null&&s(e).region.isp!=null&&s(e).region.isp.length>0?(o(),n("tr",We,[Ve,t("td",null,l(s(e).region.isp),1)])):i("",!0)])]),_:1})])):i("",!0)]),_:1}))}};export{Ee as default};
