import{o as u,c as q,w as p,j as Z,r as K,g as _,i as V,C as Q,a as D,u as r,d as G,h as I,b as R,f as d,t as f,F as X,D as Y,ae as ee}from"./app-BYx064nO.js";import{u as J}from"./app-DISTCiac.js";import{C as B}from"./app-IrmNFWm4.js";import{_ as $}from"./app-DOex4tCl.js";import{T as oe}from"./app-DNadG4GC.js";import{_ as re}from"./app-DQ_aQJ5G.js";const O=new function(){this.utf16={decode:function(o){for(var i=[],a=0,l=o.length,s,g;a<l;){if(s=o.charCodeAt(a++),(s&63488)===55296){if(g=o.charCodeAt(a++),(s&64512)!==55296||(g&64512)!==56320)throw new RangeError("UTF-16(decode): Illegal UTF-16 sequence");s=((s&1023)<<10)+(g&1023)+65536}i.push(s)}return i},encode:function(o){for(var i=[],a=0,l=o.length,s;a<l;){if(s=o[a++],(s&63488)===55296)throw new RangeError("UTF-16(encode): Illegal UTF-16 value");s>65535&&(s-=65536,i.push(String.fromCharCode(s>>>10&1023|55296)),s=56320|s&1023),i.push(String.fromCharCode(s))}return i.join("")}};var T=128,U=72,A="-",e=36,j=700,M=1,E=26,N=38,S=2147483647;function n(o){return o-48<10?o-22:o-65<26?o-65:o-97<26?o-97:e}function c(o,i){return o+22+75*(o<26)-((i!=0)<<5)}function b(o,i,a){var l;for(o=a?Math.floor(o/j):o>>1,o+=Math.floor(o/i),l=0;o>(e-M)*E>>1;l+=e)o=Math.floor(o/(e-M));return Math.floor(l+(e-M+1)*o/(o+N))}function L(o,i){return o-=(o-97<26)<<5,o+((!i&&o-65<26)<<5)}this.decode=function(o,i){var a=[],l=[],s=o.length,g,k,t,w,h,m,v,C,y,F,x,H,z;for(g=T,t=0,w=U,h=o.lastIndexOf(A),h<0&&(h=0),m=0;m<h;++m){if(i&&(l[a.length]=o.charCodeAt(m)-65<26),o.charCodeAt(m)>=128)throw new RangeError("Illegal input >= 0x80");a.push(o.charCodeAt(m))}for(v=h>0?h+1:0;v<s;){for(C=t,y=1,F=e;;F+=e){if(v>=s)throw RangeError("punycode_bad_input(1)");if(x=n(o.charCodeAt(v++)),x>=e)throw RangeError("punycode_bad_input(2)");if(x>Math.floor((S-t)/y))throw RangeError("punycode_overflow(1)");if(t+=x*y,H=F<=w?M:F>=w+E?E:F-w,x<H)break;if(y>Math.floor(S/(e-H)))throw RangeError("punycode_overflow(2)");y*=e-H}if(k=a.length+1,w=b(t-C,k,C===0),Math.floor(t/k)>S-g)throw RangeError("punycode_overflow(3)");g+=Math.floor(t/k),t%=k,i&&l.splice(t,0,o.charCodeAt(v-1)-65<26),a.splice(t,0,g),t++}if(i)for(t=0,z=a.length;t<z;t++)l[t]&&(a[t]=String.fromCharCode(a[t]).toUpperCase().charCodeAt(0));return this.utf16.encode(a)},this.encode=function(o,i){var a,l,s,g,k,t,w,h,m,v,C,y;i&&(y=this.utf16.decode(o)),o=this.utf16.decode(o.toLowerCase());var F=o.length;if(i)for(t=0;t<F;t++)y[t]=o[t]!=y[t];var x=[];for(a=T,l=0,k=U,t=0;t<F;++t)o[t]<128&&x.push(String.fromCharCode(y?L(o[t],y[t]):o[t]));for(s=g=x.length,g>0&&x.push(A);s<F;){for(w=S,t=0;t<F;++t)C=o[t],C>=a&&C<w&&(w=C);if(w-a>Math.floor((S-l)/(s+1)))throw RangeError("punycode_overflow (1)");for(l+=(w-a)*(s+1),a=w,t=0;t<F;++t){if(C=o[t],C<a&&++l>S)return Error("punycode_overflow(2)");if(C==a){for(h=l,m=e;v=m<=k?M:m>=k+E?E:m-k,!(h<v);m+=e)x.push(String.fromCharCode(c(v+(h-v)%(e-v),0))),h=Math.floor((h-v)/(e-v));x.push(String.fromCharCode(c(h,i&&y[t]?1:0))),k=b(l,s+1,s==g),l=0,++s}}++l,++a}return x.join("")},this.ToASCII=function(o){for(var i=o.split("."),a=[],l=0;l<i.length;++l){var s=i[l];a.push(s.match(/[^A-Za-z0-9-]/)?"xn--"+punycode.encode(s):s)}return a.join(".")},this.ToUnicode=function(o){for(var i=o.split("."),a=[],l=0;l<i.length;++l){var s=i[l];a.push(s.match(/^xn--/)?punycode.decode(s.slice(4)):s)}return a.join(".")}},te={__name:"CodeLabelPlain",setup(P){return(T,U)=>(u(),q(oe,{outlined:"",size:"tiny"},{default:p(()=>[Z(T.$slots,"default")]),_:3}))}},W={__name:"IPBox",props:["v-ip"],setup(P){J();const T=K(),U=function(){};return(A,e)=>(u(),_("span",{onClick:e[0]||(e[0]=V(j=>U(),["prevent"])),ref_key:"containerRef",ref:T},[Z(A.$slots,"default")],512))}},ne=["href"],se=D("span",{class:"grey"},"[网站]",-1),ae=[se],le=D("span",{class:"disabled"},"[网站]",-1),ie=[le],ue={key:2,class:"grey"},de={key:6},fe={key:7},ce=["href"],he={key:0},ve={key:1},pe={key:8},_e={key:9,class:"grey small"},ge=D("i",{class:"icon expand"},null,-1),we=[ge],Fe={__name:"HTTPAccessLogBox",props:["v-access-log","v-keyword","v-show-server-link"],setup(P){const T=J(),U=P,A=K(),{accessLog:e}=function(){let n=U.vAccessLog;if(n.header!=null&&n.header.Upgrade!=null&&n.header.Upgrade.values!=null&&n.header.Upgrade.values.$contains("websocket")&&(n.scheme=="http"?n.scheme="ws":n.scheme=="https"&&(n.scheme="wss")),n.tags!=null&&n.tags.length>0){let c={};n.tags=n.tags.$filter(function(b,L){let o=typeof c[L]>"u";return c[L]=!0,o})}if(n.unicodeHost="",n.host!=null&&n.host.startsWith("xn--")){let c=n.host.indexOf(":");c>0?n.unicodeHost=O.ToUnicode(n.host.substring(0,c)):n.unicodeHost=O.ToUnicode(n.host)}return{accessLog:K(n)}}(),j=function(n){if(n==null)return"0";let c=(n*1e3).toString(),b=c.split(".");return b.length<2?c:b[0]+"."+b[1].substring(0,3)},M=function(){let n=e.value.requestId;E(),T.popup("/servers/server/log/viewPopup?requestId="+n,{width:"50em",height:"32em",onClose:function(){N()}})},E=function(){A.value.parentNode.style.cssText="background: rgba(0, 0, 0, 0.1)"},N=function(){A.value.parentNode.style.cssText=""},S=function(){T.warn("当前访问没有匹配到任何网站")};return(n,c)=>{const b=Q("tooltip");return u(),_("div",{style:ee([{"word-break":"break-all"},{color:r(e).status>=400?"#dc143c":""}]),ref_key:"boxRef",ref:A},[D("div",null,[n.vShowServerLink&&r(e).serverId>0?G((u(),_("a",{key:0,href:"/servers/server/log?serverId="+r(e).serverId},ae,8,ne)),[[b,"点击到网站",void 0,{bottom:!0}]]):I("",!0),n.vShowServerLink&&(r(e).serverId==null||r(e).serverId==0)?(u(),_("span",{key:1,onClick:c[0]||(c[0]=V(L=>S(),["prevent"]))},ie)):I("",!0),r(e).region!=null&&r(e).region.length>0?(u(),_("span",ue,[R(W,{"v-ip":r(e).remoteAddr},{default:p(()=>[d("["+f(r(e).region)+"]",1)]),_:1},8,["v-ip"])])):I("",!0),R(W,null,{default:p(()=>[R($,{"v-word":n.vKeyword},{default:p(()=>[d(f(r(e).remoteAddr),1)]),_:1},8,["v-word"])]),_:1}),d(" ["+f(r(e).timeLocal)+"] ",1),D("em",null,[d('"'),R($,{"v-word":n.vKeyword},{default:p(()=>[d(f(r(e).requestMethod),1)]),_:1},8,["v-word"]),d(" "+f(r(e).scheme)+"://",1),R($,{"v-word":n.vKeyword},{default:p(()=>[d(f(r(e).host),1)]),_:1},8,["v-word"]),R($,{"v-word":n.vKeyword},{default:p(()=>[d(f(r(e).requestURI),1)]),_:1},8,["v-word"]),R(re,{text:r(e).scheme+"://"+r(e).host+r(e).requestURI,tooltip:"复制URL",class:"disabled px-1"},null,8,["text"]),d(" "+f(r(e).proto)+'" ',1)]),R($,{"v-word":n.vKeyword},{default:p(()=>[d(f(r(e).status),1)]),_:1},8,["v-word"]),r(e).unicodeHost!=null&&r(e).unicodeHost.length>0?(u(),q(B,{key:3},{default:p(()=>[d(f(r(e).unicodeHost),1)]),_:1})):I("",!0),r(e).attrs!=null&&(r(e).attrs["cache.status"]=="HIT"||r(e).attrs["cache.status"]=="STALE")?(u(),q(B,{key:4},{default:p(()=>[d("cache "+f(r(e).attrs["cache.status"].toLowerCase()),1)]),_:1})):I("",!0),r(e).firewallActions!=null&&r(e).firewallActions.length>0?(u(),q(B,{key:5},{default:p(()=>[d("waf "+f(r(e).firewallActions),1)]),_:1})):I("",!0),r(e).tags!=null&&r(e).tags.length>0?(u(),_("span",de,[d("- "),(u(!0),_(X,null,Y(r(e).tags,L=>(u(),q(B,{key:L},{default:p(()=>[d(f(L),1)]),_:2},1024))),128))])):I("",!0),r(e).wafInfo!=null&&r(e).wafInfo.policy!=null?(u(),_("span",fe,[D("a",{href:r(e).wafInfo.policy.serverId==0?"/servers/components/waf/group?firewallPolicyId="+r(e).firewallPolicyId+"&type=inbound&groupId="+r(e).firewallRuleGroupId+"#set"+r(e).firewallRuleSetId:"/servers/server/settings/waf/group?serverId="+r(e).serverId+"&firewallPolicyId="+r(e).firewallPolicyId+"&type=inbound&groupId="+r(e).firewallRuleGroupId+"#set"+r(e).firewallRuleSetId,target:"_blank"},[R(te,null,{default:p(()=>[D("span",null,[d(" WAF - "),r(e).wafInfo.group!=null?(u(),_("span",he,f(r(e).wafInfo.group.name)+" -",1)):I("",!0),r(e).wafInfo.set!=null?(u(),_("span",ve,f(r(e).wafInfo.set.name),1)):I("",!0)])]),_:1})],8,ce)])):I("",!0),r(e).requestTime!=null?(u(),_("span",pe," - 耗时:"+f(j(r(e).requestTime))+" ms ",1)):I("",!0),r(e).humanTime!=null&&r(e).humanTime.length>0?(u(),_("span",_e,"  ("+f(r(e).humanTime)+")",1)):I("",!0),d("   "),G((u(),_("a",{href:"",onClick:V(M,["prevent"])},we)),[[b,"查看详情",void 0,{bottom:!0}]])])],4)}}};export{Fe as _};
