import{r as B,o as t,c as u,w as a,b as h,a as p,i as _,n as L,f as n,t as O,h as o,g as k,F as M,D as U,u as v,aa as z}from"./app-BYx064nO.js";import{u as N}from"./app-DISTCiac.js";import{_ as m}from"./app-DU3b6xa5.js";import{_ as V}from"./app-CmboutmR.js";import{L as E}from"./app-Vf6It1y-.js";import{_ as C}from"./app-CfEaOsVA.js";import{_ as D}from"./app-x_fVWXrx.js";const S=["onClick"],F=p("i",{class:"icon expand small"},null,-1),j={class:"label-group mt-1"},H=p("i",{class:"icon database"},null,-1),W=["onClick"],q=["onClick"],G=["onClick"],J=p("span",{class:"red"},"启用",-1),K=[J],Q=["onClick"],x={__name:"OriginListTable",props:["v-origins","v-origin-type"],emits:["delete-origin","update-origin","update-origin-is-on"],setup(P,{emit:r}){const g=P,c=r,{hasMatchedDomains:b}=function(){let i=!1,l=g.vOrigins;return l!=null&&l.length>0&&l.forEach(function(e){e.domains!=null&&e.domains.length>0&&(i=!0)}),{hasMatchedDomains:B(i)}}(),y=function(i,l){c("delete-origin",i,l,g.vOriginType)},w=function(i){c("update-origin",i,g.vOriginType)},$=function(i,l,e){c("update-origin-is-on",i,l,e)};return(i,l)=>(t(),u(E,{items:i.vOrigins},{default:a(()=>[h(C,{header:"源站地址",class:"url-column",frozen:""},{body:a(({data:e})=>[p("a",{href:"",onClick:_(s=>w(e.id),["prevent"]),class:L({disabled:!e.isOn})},[n(O(e.addr)+"  ",1),F],10,S),p("div",j,[e.isOSS?(t(),u(m,{key:0},{default:a(()=>[H,n(" 对象存储 ")]),_:1})):o("",!0),e.name.length>0?(t(),u(m,{key:1},{default:a(()=>[n(O(e.name),1)]),_:2},1024)):o("",!0),e.hasCert?(t(),u(m,{key:2},{default:a(()=>[n("证书")]),_:1})):o("",!0),e.host!=null&&e.host.length>0?(t(),u(m,{key:3},{default:a(()=>[n("主机名: "+O(e.host),1)]),_:2},1024)):o("",!0),e.followPort?(t(),u(m,{key:4},{default:a(()=>[n("端口跟随")]),_:1})):o("",!0),e.addr!=null&&e.addr.startsWith("https://")&&e.http2Enabled?(t(),u(m,{key:5},{default:a(()=>[n("HTTP/2")]),_:1})):o("",!0),e.domains!=null&&e.domains.length>0?(t(!0),k(M,{key:6},U(e.domains,s=>(t(),u(m,null,{default:a(()=>[n("匹配: "+O(s),1)]),_:2},1024))),256)):v(b)?(t(),u(m,{key:7},{default:a(()=>[n("匹配: 所有域名")]),_:1})):o("",!0)])]),_:1}),h(C,{header:"权重",class:"value-column"},{body:a(({data:e})=>[n(O(e.weight),1)]),_:1}),h(C,{header:"状态",class:"fixed-status-column"},{body:a(({data:e})=>[h(V,{"v-is-on":e.isOn},null,8,["v-is-on"])]),_:1}),h(C,{header:"操作",class:"three op",frozen:"","align-frozen":"right"},{body:a(({data:e})=>[p("a",{href:"",onClick:_(s=>w(e.id),["prevent"])},"修改",8,W),n("   "),e.isOn?(t(),k("a",{key:0,href:"",onClick:_(s=>$(e.id,e.addr,!1),["prevent"])},"停用",8,q)):o("",!0),e.isOn?o("",!0):(t(),k("a",{key:1,href:"",onClick:_(s=>$(e.id,e.addr,!0),["prevent"])},K,8,G)),n("   "),p("a",{href:"",onClick:_(s=>y(e.id,e.addr),["prevent"])},"删除",8,Q)]),_:1})]),_:1},8,["items"]))}},R={class:"!mb-4"},X={key:0,class:"comment"},Y={class:"group-header"},Z={key:2,class:"comment"},oe={__name:"OriginListBox",props:["v-primary-origins","v-backup-origins","v-server-type","v-params"],setup(P){const r=N(),g=z("$Tea"),c=P,{primaryOrigins:b,backupOrigins:y}=function(){return{primaryOrigins:B(c.vPrimaryOrigins),backupOrigins:B(c.vBackupOrigins)}}(),w=function(){r.popup("/servers/server/settings/origins/addPopup?originType=primary&"+c.vParams,{width:"45em",height:"36em",callback:function(s){r.success("保存成功",function(){window.location.reload()})}})},$=function(){r.popup("/servers/server/settings/origins/addPopup?originType=backup&"+c.vParams,{width:"45em",height:"36em",callback:function(s){r.success("保存成功",function(){window.location.reload()})}})},i=function(s,d){r.popup("/servers/server/settings/origins/updatePopup?originType="+d+"&"+c.vParams+"&originId="+s,{width:"45em",height:"36em",callback:function(f){r.success("保存成功",function(){window.location.reload()})}})},l=function(s,d,f){r.confirm("确定要删除此源站（"+d+"）吗？",function(){g.action("/servers/server/settings/origins/delete?"+c.vParams+"&originId="+s+"&originType="+f).post().success(function(){r.success("删除成功",function(){window.location.reload()})})})},e=function(s,d,f){let T,I;f?(T="确定要启用此源站（"+d+"）吗？",I="启用成功"):(T="确定要停用此源站（"+d+"）吗？",I="停用成功"),r.confirm(T,function(){g.action("/servers/server/settings/origins/updateIsOn?"+c.vParams+"&originId="+s+"&isOn="+(f?1:0)).post().success(function(){r.success(I,function(){window.location.reload()})})})};return(s,d)=>(t(),k("div",null,[p("h5",R,[n("主要源站 "),p("a",{href:"",onClick:d[0]||(d[0]=_(f=>w(),["prevent"]))},"[添加主要源站]"),h(D,{content:"主要源站为日常使用的源站，如果添加多个源站，可以根据权重随机调用。"})]),v(b).length==0?(t(),k("p",X,"暂时还没有主要源站。")):o("",!0),v(b).length>0?(t(),u(x,{key:1,"v-origins":s.vPrimaryOrigins,"v-origin-type":"primary",onDeleteOrigin:l,onUpdateOrigin:i,onUpdateOriginIsOn:e},null,8,["v-origins"])):o("",!0),p("h5",Y,[n("备用源站 "),p("a",{href:"",onClick:d[1]||(d[1]=_(f=>$(),["prevent"]))},"[添加备用源站]"),h(D,{content:"备用源站为备用的源站，当所有的主要源站都无法访问时，会自动切换到备用源站；如果有多个备用源站，也可以根据权重随机调用；如果主要源站中的任一源站恢复可访问状态时，系统会自动切换回主要源站。"})]),v(y).length==0?(t(),k("p",Z,"暂时还没有备用源站。")):o("",!0),v(y).length>0?(t(),u(x,{key:3,"v-origins":v(y),"v-origin-type":"backup",onDeleteOrigin:l,onUpdateOrigin:i,onUpdateOriginIsOn:e},null,8,["v-origins"])):o("",!0)]))}};export{oe as _};
