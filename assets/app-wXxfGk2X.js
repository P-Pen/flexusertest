import{i as T,u as U,c as S}from"./app-DISTCiac.js";import{_ as V}from"./app-_N2IGwgj.js";import{_ as F}from"./app-57xpzLDR.js";import{r as L,o as e,g as c,a as m,u as n,b as i,w as r,c as P,h as u,d as k,e as b,f as p,t as o,F as x,D as R,i as C}from"./app-BYx064nO.js";import{_ as H}from"./app--BlRpVz_.js";import{_ as G}from"./app-Bx5jiAm1.js";import{_ as I}from"./app-DU3b6xa5.js";import{_ as z}from"./app-CmboutmR.js";import{D as E}from"./app-D0jdtzyy.js";import{L as M}from"./app-Vf6It1y-.js";import{_ as d}from"./app-CfEaOsVA.js";import{_ as q}from"./app-AqjyBPEM.js";import{_ as J}from"./app-BAIc7wsg.js";import{_ as K}from"./app-C7gR9zYq.js";import"./app-DR284fT9.js";import"./app-tUtHmy3n.js";import"./app-CK9Tk_hc.js";import"./app-DNadG4GC.js";import"./app-DPMEyUYH.js";import"./app-BZMTWmMM.js";import"./app-51hQc1Cd.js";import"./app-CqAVEB_b.js";import"./app-Cqxz9tud.js";import"./app-DoRtcMJm.js";import"./app-aIb4ksxL.js";import"./app-DYkSpHuE.js";import"./app-DyIe33QU.js";import"./app-CiA1rHoH.js";import"./app-DOaxShSm.js";import"./app-RbQF51V8.js";import"./app-DGM5HqRo.js";import"./app-DG0hMi2p.js";import"./app-CBq6-G9z.js";import"./app-BXvxi6wb.js";import"./app-C9w-bzHc.js";import"./app-5V9SnxW6.js";import"./app-DQhYsbJs.js";import"./app-BXiLqtxA.js";import"./app-CqvvE0jO.js";import"./app-CAeEyuA3.js";function j(){T(this),this.success=this.$NotifyReloadSuccess("保存成功"),this.changeMethods=function(v){this.$refs.authForm.submit()}}const Q=["value"],W=m("td",{class:"title"},"启用鉴权",-1),X=m("h5",{class:"group-header"},"鉴权方式",-1),Y={key:0},Z={key:1},tt={key:0,class:"grey"},et={key:2},at={key:3},st={key:4},ot={key:5},it={key:6,class:"label-group mt-1"},nt=["onClick"],ct=["onClick"],ut={class:"mt-4"},rt={__name:"HTTPAuthConfigBox",props:["v-auth-config","v-is-location"],emits:["change"],setup(v,{emit:_}){const s=U(),g=v,y=_,{authConfig:l}=function(){let a=g.vAuthConfig;return a==null&&(a={isPrior:!1,isOn:!1}),a.policyRefs==null&&(a.policyRefs=[]),{authConfig:L(a)}}(),O=function(){return(!g.vIsLocation||l.value.isPrior)&&l.value.isOn},N=function(){s.popup("/servers/server/settings/access/createPopup",{callback:function(a){l.value.policyRefs.push(a.data.policyRef),$()},height:s.POPUP_HEIGHT_LG})},w=function(a,f){s.popup("/servers/server/settings/access/updatePopup?policyId="+f,{callback:function(t){s.success("保存成功",function(){s.reload()})},height:s.POPUP_HEIGHT_LG})},B=function(a){l.value.policyRefs.$remove(a),$()},A=function(a){switch(a){case"basicAuth":return"BasicAuth";case"subRequest":return"子请求";case"typeA":return"URL鉴权A";case"typeB":return"URL鉴权B";case"typeC":return"URL鉴权C";case"typeD":return"URL鉴权D"}return""},$=function(){setTimeout(function(){y("change",l.value)},100)};return(a,f)=>(e(),c("div",null,[m("input",{type:"hidden",name:"authJSON",value:JSON.stringify(n(l))},null,8,Q),i(E,null,{default:r(()=>[a.vIsLocation?(e(),P(G,{key:0,"v-config":n(l)},null,8,["v-config"])):u("",!0),k(m("tbody",null,[m("tr",null,[W,m("td",null,[i(H,{modelValue:n(l).isOn,"onUpdate:modelValue":f[0]||(f[0]=t=>n(l).isOn=t)},null,8,["modelValue"])])])],512),[[b,!a.vIsLocation||n(l).isPrior]])]),_:1}),k(m("div",null,[X,k(m("div",null,[i(M,{items:n(l).policyRefs,dataKey:"authPolicyId"},{default:r(()=>[i(d,{header:"名称",class:"name-column",frozen:""},{body:r(({data:t})=>[p(o(t.authPolicy.name),1)]),_:1}),i(d,{header:"鉴权方法",class:"normal-value-column"},{body:r(({data:t})=>[p(o(A(t.authPolicy.type)),1)]),_:1}),i(d,{header:"参数",class:"description-column"},{body:r(({data:t})=>[t.authPolicy.type=="basicAuth"?(e(),c("span",Y,o(t.authPolicy.params.users.length)+"个用户",1)):u("",!0),t.authPolicy.type=="subRequest"?(e(),c("span",Z,[t.authPolicy.params.method.length>0?(e(),c("span",tt,"["+o(t.authPolicy.params.method)+"]",1)):u("",!0),p(" "+o(t.authPolicy.params.url),1)])):u("",!0),t.authPolicy.type=="typeA"?(e(),c("span",et,o(t.authPolicy.params.signParamName)+"/有效期"+o(t.authPolicy.params.life)+"秒",1)):u("",!0),t.authPolicy.type=="typeB"?(e(),c("span",at,"有效期"+o(t.authPolicy.params.life)+"秒",1)):u("",!0),t.authPolicy.type=="typeC"?(e(),c("span",st,"有效期"+o(t.authPolicy.params.life)+"秒",1)):u("",!0),t.authPolicy.type=="typeD"?(e(),c("span",ot,o(t.authPolicy.params.signParamName)+"/"+o(t.authPolicy.params.timestampParamName)+"/有效期"+o(t.authPolicy.params.life)+"秒",1)):u("",!0),t.authPolicy.params.exts!=null&&t.authPolicy.params.exts.length>0||t.authPolicy.params.domains!=null&&t.authPolicy.params.domains.length>0?(e(),c("div",it,[t.authPolicy.params.exts!=null?(e(!0),c(x,{key:0},R(t.authPolicy.params.exts,h=>(e(),P(I,null,{default:r(()=>[p("扩展名："+o(h),1)]),_:2},1024))),256)):u("",!0),t.authPolicy.params.domains!=null?(e(!0),c(x,{key:1},R(t.authPolicy.params.domains,h=>(e(),P(I,null,{default:r(()=>[p("域名："+o(h),1)]),_:2},1024))),256)):u("",!0)])):u("",!0)]),_:1}),i(d,{header:"状态",class:"fixed-status-column"},{body:r(({data:t})=>[i(z,{"v-is-on":t.authPolicy.isOn},null,8,["v-is-on"])]),_:1}),i(d,{header:"操作",class:"two op",frozen:"","align-frozen":"right"},{body:r(({data:t,index:h})=>[m("a",{href:"",onClick:C(D=>w(h,t.authPolicyId),["prevent"])},"修改",8,nt),p("   "),m("a",{href:"",onClick:C(D=>B(h),["prevent"])},"删除",8,ct)]),_:1})]),_:1},8,["items"])],512),[[b,n(l).policyRefs.length>0]]),m("div",ut,[i(q,{small:"",type:"button",onClick:C(N,["prevent"]),"action-create":""},{default:r(()=>[p("添加鉴权方式")]),_:1})])],512),[[b,O()]])]))}},lt={key:0},mt=["value"],pt={key:1},Zt={__name:"index",setup(v){const _=L(),s=S(new j,{refs:{authForm:_}});return(g,y)=>(e(),P(J,{ctx:n(s)},{default:r(()=>[n(s).featureIsOn?(e(),c("div",lt,[i(V,{action:"$",onSuccess:n(s).success,ref_key:"authForm",ref:_},{default:r(()=>[m("input",{type:"hidden",name:"webId",value:n(s).webId},null,8,mt),i(rt,{"v-auth-config":n(s).authConfig,onChange:n(s).changeMethods},null,8,["v-auth-config","onChange"]),i(F,{onRef:y[0]||(y[0]=()=>{}),class:"mt-4"})]),_:1},8,["onSuccess"])])):u("",!0),n(s).featureIsOn?u("",!0):(e(),c("div",pt,[i(K,null,{default:r(()=>[p("尚未为当前用户开通此功能。")]),_:1})]))]),_:1},8,["ctx"]))}};export{Zt as default};
