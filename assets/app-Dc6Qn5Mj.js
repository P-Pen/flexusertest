import{o as a,g as d,t as x,r as h,a as e,u as s,F as S,D as K,c as N,w as r,h as _,f as o,b as n,i as v,L as J,d as $,e as T,a_ as k}from"./app-BYx064nO.js";import{i as L,c as M}from"./app-DISTCiac.js";import{_ as W}from"./app-CYinca2p.js";import{_ as j}from"./app-57xpzLDR.js";import{_ as A}from"./app-NGGpq8sj.js";import{_ as G,a as C}from"./app-BuHt2kYS.js";import{_ as P}from"./app-e1i_B4SR.js";import{_ as V}from"./app-C5GVF480.js";import{_ as Q}from"./app-_N2IGwgj.js";import{_ as I}from"./app--BlRpVz_.js";import{_ as X}from"./app-Clyhl9p_.js";import{W as Y}from"./app-DQhYsbJs.js";import{_ as Z}from"./app-GgeXi7fS.js";import{_ as ee}from"./app-DgdrJsIw.js";import{_ as E}from"./app-CM0k0GHT.js";import{T as q}from"./app-DR284fT9.js";import{T as te}from"./app-DNadG4GC.js";import{D as se}from"./app-D0jdtzyy.js";import"./app-CxqGeHsb.js";import"./app-Dj8c2KwC.js";import"./app-cRxw2ZDj.js";import"./app-DOaxShSm.js";import"./app-5V9SnxW6.js";import"./app-Ncl-Sitd.js";import"./app-DoTJvLi7.js";import"./app-51hQc1Cd.js";import"./app-CqAVEB_b.js";import"./app-CK9Tk_hc.js";import"./app-Cqxz9tud.js";import"./app-DoRtcMJm.js";import"./app-aIb4ksxL.js";import"./app-DYkSpHuE.js";import"./app-DyIe33QU.js";import"./app-DGM5HqRo.js";import"./app-tUtHmy3n.js";import"./app-kBNY2ZLt.js";import"./app-BXiLqtxA.js";import"./app-CqvvE0jO.js";import"./app-CAeEyuA3.js";import"./app-DPMEyUYH.js";import"./app-x_fVWXrx.js";import"./app-TBcc1obG.js";function ne(){const{utils:g,Tea:c}=L(this);this.supportHTTPS=!1,this.requestHostType=0,this.requestHost="",this.success=function(t){t.data.hasOSS?this.$NotifySuccess("保存成功","/servers/server/settings/reverseProxy?serverId="+t.data.serverId)():this.$NotifySuccess("保存成功","/servers")()},this.fail=function(t){let m=this;g.warn(t.message,function(){t.data.requireServerNames&&m.$refs.serverNameBox.addServerName()})},this.findServerNames=function(){return this.$refs.serverNameBox.allServerNames()}}const oe={__name:"TimeDurationText",props:["v-value"],setup(g){const c=function(t){switch(t){case"ms":return"毫秒";case"second":return"秒";case"minute":return"分钟";case"hour":return"小时";case"day":return"天"}};return(t,m)=>(a(),d("span",null,x(t.vValue.count)+" "+x(c(t.vValue.unit)),1))}},le=["value"],ae={key:0,class:"label-group"},ie={key:0},re={key:1},ue={class:"grey small"},de=["onClick"],ce=e("i",{class:"icon remove"},null,-1),pe=[ce],me={class:"ui fields inline"},_e={class:"ui field"},fe={class:"ui field"},ve={class:"ui field"},he=e("i",{class:"icon remove small"},null,-1),ye=[he],$e={class:"ui fields inline"},Te={class:"ui field"},xe={class:"ui field"},ge={class:"ui field"},He=e("i",{class:"icon remove small"},null,-1),ke=[He],qe={style:{"margin-top":"1em"}},Ne={__name:"CacheCondBox",setup(g){const c=h(),t=h(),{conds:m,addingExt:i,addingPath:l,extDuration:D,pathDuration:w}=function(){return{conds:h([]),addingExt:h(!1),addingPath:h(!1),extDuration:h(null),pathDuration:h(null)}}(),R=function(){i.value=!i.value,l.value=!1,i.value&&setTimeout(function(){c.value!=null&&c.value.focus()})},U=function(u){D.value=u},b=function(){let u=c.value.value;if(u.length==0)return;let y=[];u.split(/[,，]/).forEach(function(p){p=p.trim(),p=p.replace(/\s+/,""),p.length>0&&(p[0]!="."&&(p="."+p),y.push(p))}),m.value.push({type:"url-extension",value:JSON.stringify(y),duration:D.value}),c.value.value="",H()},z=function(){i.value=!1,l.value=!l.value,l.value&&setTimeout(function(){t.value!=null&&t.value.focus()})},F=function(u){w.value=u},B=function(){let u=t.value.value;u.length!=0&&(u[0]!="/"&&(u="/"+u),m.value.push({type:"url-prefix",value:u,duration:w.value}),t.value.value="",H())},O=function(u){m.value.$remove(u)},H=function(){i.value=!1,l.value=!1};return(u,y)=>(a(),d("div",null,[e("input",{type:"hidden",name:"cacheCondsJSON",value:JSON.stringify(s(m))},null,8,le),s(m).length>0?(a(),d("div",ae,[(a(!0),d(S,null,K(s(m),(f,p)=>(a(),N(te,{outlined:""},{default:r(()=>[f.type=="url-extension"?(a(),d("span",ie,"扩展名")):_("",!0),f.type=="url-prefix"?(a(),d("span",re,"路径")):_("",!0),o("："+x(f.value)+"   ",1),e("span",ue,[o("("),n(oe,{"v-value":f.duration},null,8,["v-value"]),o(")")]),o("   "),e("a",{href:"",title:"删除",onClick:v(We=>O(p),["prevent"])},pe,8,de)]),_:2},1024))),256)),n(J)])):_("",!0),$(e("div",null,[e("div",me,[e("div",_e,[n(V,{type:"text",placeholder:"扩展名，比如.png, .gif，英文逗号分割",style:{width:"20em"},ref_key:"extInputRef",ref:c,onKeyup:k(b,["enter"]),onKeypress:k(v(f=>1,["prevent"]),["enter"])},null,8,["onKeypress"])]),e("div",fe,[n(E,{placeholder:"缓存时长","v-unit":"day","v-count":1,onChange:U})]),e("div",ve,[n(q,{secondary:"",size:"small",onClick:v(b,["prevent"])},{default:r(()=>[o("确定")]),_:1}),o("   "),e("a",{href:"",title:"取消",onClick:y[0]||(y[0]=v(f=>H(),["prevent"]))},ye)])])],512),[[T,s(i)]]),$(e("div",null,[e("div",$e,[e("div",Te,[n(V,{type:"text",placeholder:"路径，以/开头",style:{width:"20em"},ref_key:"pathInputRef",ref:t,onKeyup:k(B,["enter"]),onKeypress:k(v(f=>1,["prevent"]),["enter"])},null,8,["onKeypress"])]),e("div",xe,[n(E,{placeholder:"缓存时长","v-unit":"day","v-count":1,onChange:F})]),e("div",ge,[n(q,{type:"button",secondary:"",size:"small",onClick:v(B,["prevent"])},{default:r(()=>[o("确定")]),_:1}),o("  "),e("a",{href:"",title:"取消",onClick:y[1]||(y[1]=v(f=>H(),["prevent"]))},ke)])])],512),[[T,s(l)]]),e("div",qe,[n(q,{type:"button",secondary:"",size:"small",onClick:v(R,["prevent"])},{default:r(()=>[o("+缓存扩展名")]),_:1}),o("   "),n(q,{type:"button",secondary:"",size:"small",onClick:v(z,["prevent"])},{default:r(()=>[o("+缓存路径")]),_:1})])]))}},Ce=e("td",{class:"title"},"加速域名 *",-1),Pe=e("td",null,"域名协议 *",-1),Se={class:"flex items-center"},Ve=e("td",null,"HTTPS证书 *",-1),De=e("td",null,"源站信息 *",-1),we=e("td",null,"回源主机名 *",-1),be={style:{"margin-top":"0.8em"}},Be={class:"comment"},Ie={key:0},Ee={key:1},Ke={key:2},Re=e("td",null,"缓存设置",-1),Ue={key:0},ze=e("input",{type:"hidden",name:"isChanged",value:"1"},null,-1),Fe={key:0,class:"disabled"},Oe={key:1,class:"red"},Je=e("a",{href:"/plans"},[e("span",{class:"red"},"当前还没有可以使用的套餐，请先购买套餐")],-1),Le={key:2},Me=e("td",null,"所属分组",-1),It={__name:"create",setup(g){const c=h(),t=M(new ne,{refs:{serverNameBox:c}});return(m,i)=>(a(),d(S,null,[n(W,{"active-tab":"create"}),$(n(Y,null,{default:r(()=>[o(" 需要管理员在后台设置当前用户所属集群后才能继续操作。 ")]),_:1},512),[[T,s(t).clusterId==0]]),$(n(Q,{action:"$",onSuccess:s(t).success,onFail:s(t).fail},{default:r(()=>[n(se,null,{default:r(()=>[e("tbody",null,[e("tr",null,[Ce,e("td",null,[n(Z,{ref_key:"serverNameBox",ref:c},null,512)])]),e("tr",null,[Pe,e("td",null,[e("div",Se,[n(I,{name:"protocols",value:"http"},{default:r(()=>[o("HTTP")]),_:1}),o("       "),n(I,{name:"protocols",value:"https",modelValue:s(t).supportHTTPS,"onUpdate:modelValue":i[0]||(i[0]=l=>s(t).supportHTTPS=l)},{default:r(()=>[o("HTTPS")]),_:1},8,["modelValue"])])])]),$(e("tr",null,[Ve,e("td",null,[n(X,{"v-domains":s(t).findServerNames},null,8,["v-domains"])])],512),[[T,s(t).supportHTTPS]]),e("tr",null,[De,e("td",null,[n(ee,{"v-oss-types":s(t).ossTypes},null,8,["v-oss-types"])])]),e("tr",null,[we,e("td",null,[n(P,{name:"requestHostType",value:0,modelValue:s(t).requestHostType,"onUpdate:modelValue":i[1]||(i[1]=l=>s(t).requestHostType=l)},{default:r(()=>[o("跟随CDN服务")]),_:1},8,["modelValue"]),o("   "),n(P,{name:"requestHostType",value:1,modelValue:s(t).requestHostType,"onUpdate:modelValue":i[2]||(i[2]=l=>s(t).requestHostType=l)},{default:r(()=>[o("跟随源站")]),_:1},8,["modelValue"]),o("   "),n(P,{name:"requestHostType",value:2,modelValue:s(t).requestHostType,"onUpdate:modelValue":i[3]||(i[3]=l=>s(t).requestHostType=l)},{default:r(()=>[o("自定义")]),_:1},8,["modelValue"]),$(e("div",be,[n(V,{name:"requestHost",placeholder:"比如example.com",modelValue:s(t).requestHost,"onUpdate:modelValue":i[4]||(i[4]=l=>s(t).requestHost=l),class:"w-full"},null,8,["modelValue"])],512),[[T,s(t).requestHostType==2]]),e("p",Be,[o("请求源站时的Host，用于设置访问源站的站点域名 "),s(t).requestHostType==0?(a(),d("span",Ie,'，"跟随CDN服务"是指访问源站的站点域名和当前CDN服务保持一致')):_("",!0),s(t).requestHostType==1?(a(),d("span",Ee,'，"跟随源站"是指访问源站的站点域名仍然是填写的源站地址中的信息，不随CDN服务域名改变而改变')):_("",!0),s(t).requestHostType==2?(a(),d("span",Ke,"，自定义Host内容中支持请求变量")):_("",!0),o("。")])])]),e("tr",null,[Re,e("td",null,[n(Ne)])]),$(e("tr",null,[e("td",null,[o("绑定套餐 "),s(t).requirePlan?(a(),d("span",Ue,"*")):_("",!0)]),e("td",null,[ze,s(t).userPlans.length==0&&!s(t).requirePlan?(a(),d("span",Fe,"当前还没有可以使用的套餐。")):_("",!0),s(t).userPlans.length==0&&s(t).requirePlan?(a(),d("span",Oe,[Je,o(" 。")])):(a(),d("div",Le,[n(G,{name:"userPlanId",filter:""},{default:r(()=>[s(t).requirePlan?_("",!0):(a(),N(C,{key:0,value:"0"},{default:r(()=>[o("[不使用套餐]")]),_:1})),s(t).requirePlan?(a(),N(C,{key:1,value:"0"},{default:r(()=>[o("[选择套餐]")]),_:1})):_("",!0),(a(!0),d(S,null,K(s(t).userPlans,l=>(a(),N(C,{value:l.id},{default:r(()=>[o(x(l.name)+"（"+x(l.dayTo)+"）",1)]),_:2},1032,["value"]))),256))]),_:1})]))])],512),[[T,s(t).requirePlan||s(t).userPlans.length>0]]),e("tr",null,[Me,e("td",null,[n(A)])])])]),_:1}),n(j)]),_:1},8,["onSuccess","onFail"]),[[T,s(t).clusterId>0]])],64))}};export{It as default};
