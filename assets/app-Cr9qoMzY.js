import{o as r,g as c,b as a,w as l,u as i,F as h,f as p,a as d,D as m,i as _,t as f,h as w,c as N,n as y}from"./app-BYx064nO.js";import{i as v,c as S}from"./app-DISTCiac.js";import{T as C,_ as b,a as P}from"./app-D_QewxY9.js";import{_ as x}from"./app-_N2IGwgj.js";import{_ as $,a as T}from"./app-BuHt2kYS.js";import{T as M}from"./app-DR284fT9.js";import{T as I}from"./app-BrXfdN3l.js";import{D as E}from"./app-D0jdtzyy.js";import"./app-51hQc1Cd.js";import"./app-CqAVEB_b.js";import"./app-CK9Tk_hc.js";import"./app-Cqxz9tud.js";import"./app-DoRtcMJm.js";import"./app-aIb4ksxL.js";import"./app-DYkSpHuE.js";import"./app-DyIe33QU.js";function V(){const{utils:k,Tea:n}=v(this);this.selectedNetworkId=0,this.selectedProtectionBandwidth="",this.selectedServerBandwidth="",this.selectedPackageId=0,this.selectedPeriodId=0,this.amount=-1,this.max=1,this.count=1,this.selectedPrice=null,this.$delay(function(){this.allNetworks.length>0&&this.selectNetwork(this.allNetworks[0].id)}),this.selectNetwork=function(o){this.selectedNetworkId=o,this.selectedProtectionBandwidth="",this.selectedServerBandwidth="",this.selectedPeriodId=0,this.amount=-1;let e=this,t=!1;this.prices.sort(function(s,u){return e.compareBits(s.protectionBandwidth,u.protectionBandwidth)}).forEach(function(s){!t&&s.networkId==e.selectedNetworkId&&(e.selectProtectionBandwidth(s.protectionBandwidth),t=!0)})},this.selectProtectionBandwidth=function(o){this.selectedProtectionBandwidth=o,this.selectedServerBandwidth="",this.selectedPeriodId=0,this.amount=-1;let e=this,t=!1;this.prices.sort(function(s,u){return e.compareBits(s.serverBandwidth,u.serverBandwidth)}).forEach(function(s){!t&&s.networkId==e.selectedNetworkId&&s.protectionBandwidth==o&&(e.selectServerBandwidth(s.serverBandwidth),t=!0)})},this.selectServerBandwidth=function(o){this.selectedServerBandwidth=o,this.selectedPeriodId=0,this.amount=-1;let e=this,t=!1;this.prices.sort(function(s,u){let B=s.periodId,g=u.periodId;return e.toPeriodMonths(e.findPeriodWithId(B))>e.toPeriodMonths(e.findPeriodWithId(g))?1:-1}).forEach(function(s){!t&&s.networkId==e.selectedNetworkId&&s.protectionBandwidth==e.selectedProtectionBandwidth&&s.serverBandwidth==o&&(e.selectPeriod(s.periodId),t=!0)})},this.selectPeriod=function(o){this.selectedPeriodId=o;let e=null,t=!1,s=this;if(this.prices.forEach(function(u){!t&&u.networkId==s.selectedNetworkId&&u.protectionBandwidth==s.selectedProtectionBandwidth&&u.serverBandwidth==s.selectedServerBandwidth&&u.periodId==s.selectedPeriodId&&(e=u,t=!0)}),e==null){k.warn("数据错误，请刷新页面后重试，如果仍然没有恢复，请联系管理员。");return}this.selectedPrice=e,this.selectedPackageId=e.packageId,this.count=1,this.max=e.maxInstances,this.changeCount(this.count)},this.hasProtectionBandwidth=function(o){if(this.prices==null)return;let e=!1,t=this;return this.prices.forEach(function(s){s.networkId==t.selectedNetworkId&&s.protectionBandwidth==o&&(e=!0)}),e},this.hasServerBandwidth=function(o){if(this.prices==null)return;let e=!1,t=this;return this.prices.forEach(function(s){s.networkId==t.selectedNetworkId&&s.protectionBandwidth==t.selectedProtectionBandwidth&&s.serverBandwidth==o&&(e=!0)}),e},this.hasPeriod=function(o){if(this.prices==null)return;let e=!1,t=this;return this.prices.forEach(function(s){s.networkId==t.selectedNetworkId&&s.protectionBandwidth==t.selectedProtectionBandwidth&&s.serverBandwidth==t.selectedServerBandwidth&&s.periodId==o&&(e=!0)}),e},this.changeCount=function(){if(this.selectedPrice==null){this.amount=-1;return}this.amount=this.selectedPrice.price*this.count,this.$post(".price").params({packageId:this.selectedPackageId,periodId:this.selectedPeriodId,count:this.count}).success(function(o){this.amount=o.data.amount})},this.goNext=function(){this.selectedPackageId>0&&this.selectedPeriodId>0&&this.count>0&&this.amount>0&&(window.location="/anti-ddos/packages/confirm?packageId="+this.selectedPackageId+"&periodId="+this.selectedPeriodId+"&count="+this.count)},this.toBits=function(o){let e=o.match(/^(\d+)(\w+)$/),t=parseInt(e[1]);switch(e[2]){case"bps":return t;case"Kbps":return t*1024;case"Mbps":return t*Math.pow(1024,2);case"Gbps":return t*Math.pow(1024,3);case"Tbps":return t*Math.pow(1024,4);case"Pbps":return t*Math.pow(1024,5)}return t},this.compareBits=function(o,e){return this.toBits(o)>this.toBits(e)?1:-1},this.findPeriodWithId=function(o){return this.allPeriods.$find(function(e,t){return t.id==o})},this.toPeriodMonths=function(o){switch(o.unit){case"year":return o.count*12;default:return o.count}}}const D=d("a",{href:"/anti-ddos/packages"},"选择实例规格",-1),z=["value"],W=["value"],F=d("td",{class:"title"},"选择线路 *",-1),G={class:"label-group"},K=["onClick"],L={key:0,class:"comment"},R=d("td",null,"选择防护带宽 *",-1),U={class:"label-group"},j=["onClick"],q=d("td",null,"选择业务带宽 *",-1),A={class:"label-group"},H=["onClick"],J=d("td",null,"选择有效期 *",-1),O={class:"label-group"},Q=["onClick"],X=d("td",null,"选择实例数量 *",-1),Y=d("td",null,"价格",-1),Z={key:0,class:"disabled"},tt={key:1},_t={__name:"index",setup(k){const n=S(new V);return(o,e)=>(r(),c(h,null,[a(C,{step:"selectInstance"},{default:l(()=>[a(b,null,{default:l(()=>[a(P,{code:"selectInstance"},{default:l(()=>[D]),_:1}),a(P,{code:"pay"},{default:l(()=>[p("支付")]),_:1})]),_:1})]),_:1}),a(x,{action:"$",onSuccess:i(n).success,class:"mt-2"},{default:l(()=>[d("input",{type:"hidden",name:"packageId",value:i(n).selectedPackageId},null,8,z),d("input",{type:"hidden",name:"periodId",value:i(n).selectedPeriodId},null,8,W),a(E,null,{default:l(()=>[d("tbody",null,[d("tr",null,[F,d("td",null,[d("div",G,[(r(!0),c(h,null,m(i(n).allNetworks,t=>(r(),c("a",{onClick:_(s=>i(n).selectNetwork(t.id),["prevent"])},[a(I,{secondary:t.id!=i(n).selectedNetworkId},{default:l(()=>[p(f(t.name),1)]),_:2},1032,["secondary"])],8,K))),256))]),(r(!0),c(h,null,m(i(n).allNetworks,t=>(r(),c(h,null,[t.id==i(n).selectedNetworkId&&t.description.length>0?(r(),c("p",L,f(t.name)+"："+f(t.description),1)):w("",!0)],64))),256))])]),d("tr",null,[R,d("td",null,[d("div",U,[(r(!0),c(h,null,m(i(n).allProtectionBandwidthSizes,t=>(r(),c(h,null,[i(n).hasProtectionBandwidth(t)?(r(),c("a",{key:0,onClick:_(s=>i(n).selectProtectionBandwidth(t),["prevent"])},[a(I,{secondary:t!=i(n).selectedProtectionBandwidth},{default:l(()=>[p(f(t),1)]),_:2},1032,["secondary"])],8,j)):w("",!0)],64))),256))])])]),d("tr",null,[q,d("td",null,[d("div",A,[(r(!0),c(h,null,m(i(n).allServerBandwidthSizes,t=>(r(),c(h,null,[i(n).hasServerBandwidth(t)?(r(),c("a",{key:0,onClick:_(s=>i(n).selectServerBandwidth(t),["prevent"])},[a(I,{secondary:t!=i(n).selectedServerBandwidth},{default:l(()=>[p(f(t),1)]),_:2},1032,["secondary"])],8,H)):w("",!0)],64))),256))])])]),d("tr",null,[J,d("td",null,[d("div",O,[(r(!0),c(h,null,m(i(n).allPeriods,t=>(r(),c(h,null,[i(n).hasPeriod(t.id)?(r(),c("a",{key:0,onClick:_(s=>i(n).selectPeriod(t.id),["prevent"])},[a(I,{secondary:t.id!=i(n).selectedPeriodId},{default:l(()=>[p(f(t.count)+f(t.unitName),1)]),_:2},1032,["secondary"])],8,Q)):w("",!0)],64))),256))])])]),d("tr",null,[X,d("td",null,[a($,{name:"count",modelValue:i(n).count,"onUpdate:modelValue":e[0]||(e[0]=t=>i(n).count=t),onChange:e[1]||(e[1]=t=>i(n).changeCount(i(n).count))},{default:l(()=>[(r(!0),c(h,null,m(i(n).max,t=>(r(),N(T,{value:t},{default:l(()=>[p(f(t),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])])]),d("tr",null,[Y,d("td",null,[i(n).amount==0?(r(),c("span",Z,"没有找到对应价格")):w("",!0),i(n).amount>0?(r(),c("span",tt,f(i(n).amount)+"元",1)):w("",!0)])])])]),_:1}),a(M,{type:"button",class:y({disabled:i(n).amount<=0}),onClick:e[2]||(e[2]=_(t=>i(n).goNext(),["prevent"]))},{default:l(()=>[p("下一步")]),_:1},8,["class"])]),_:1},8,["onSuccess"])],64))}};export{_t as default};
