import{r as k,ak as A,o as i,g as l,u as s,b as n,w as o,f as r,F as $,D as R,c as b,t as m,bb as F,h as u,aa as L,C as q,d as z,a,n as B,i as v}from"./app-BYx064nO.js";import{i as P,c as D}from"./app-DISTCiac.js";import{a as T,_ as U}from"./app-BuHt2kYS.js";import{_ as K}from"./app-C5GVF480.js";import{T as M}from"./app-DR284fT9.js";import{_ as S}from"./app-DOex4tCl.js";import{_ as W}from"./app-CmboutmR.js";import{_ as j}from"./app-266_x6q1.js";import{T as O}from"./app-BrXfdN3l.js";import{L as H,s as y}from"./app-Vf6It1y-.js";import{T as E}from"./app-DNadG4GC.js";import{_ as X}from"./app-H6wYo2xY.js";import{_ as G}from"./app-B-EzfWu7.js";import{_ as J}from"./app-B_zSIYIe.js";import{_ as Q}from"./app-AqjyBPEM.js";import"./app-51hQc1Cd.js";import"./app-CqAVEB_b.js";import"./app-CK9Tk_hc.js";import"./app-Cqxz9tud.js";import"./app-DoRtcMJm.js";import"./app-aIb4ksxL.js";import"./app-DYkSpHuE.js";import"./app-DyIe33QU.js";import"./app-BZMTWmMM.js";import"./app-CiA1rHoH.js";import"./app-DOaxShSm.js";import"./app-RbQF51V8.js";import"./app-tUtHmy3n.js";import"./app-DGM5HqRo.js";import"./app-DG0hMi2p.js";import"./app-CBq6-G9z.js";import"./app-DPMEyUYH.js";import"./app-CxqGeHsb.js";import"./app-Dj8c2KwC.js";import"./app-cRxw2ZDj.js";import"./app-5V9SnxW6.js";import"./app-Ncl-Sitd.js";import"./app-DoTJvLi7.js";import"./app-BXiLqtxA.js";import"./app-CqvvE0jO.js";import"./app-CAeEyuA3.js";function Y(){const{utils:c,Tea:f}=P(this);this.createRecord=function(){c.popup(".createPopup?domainId="+this.domain.id,{height:"36em",callback:function(){c.success("保存成功",function(){c.reload()})}})},this.updateRecord=function(e){c.popup(".updatePopup?recordId="+e,{height:"36em",callback:function(){c.success("保存成功",function(){c.reload()})}})},this.deleteRecord=function(e){let _=this;c.confirm("确定要删除此记录吗？",function(){_.$post(".delete").params({recordId:e}).success(function(){c.reload()})})},this.updateRecordHealthCheck=function(e){c.popup(".healthCheckPopup?recordId="+e,{callback:function(){c.success("设置成功",function(){c.reload()})}})},this.upRecord=function(e){e.isUp=!0,this.$post(".updateUp").params({recordId:e.id}).success(function(){c.success("操作成功",function(){c.reload()})})},this.searchWithName=function(e){this.keyword='name:"'+e+'"',this.$delay(function(){this.$refs.recordsSearchForm.submit()})},this.searchWithValue=function(e){this.keyword='value:"'+e+'"',this.$delay(function(){this.$refs.recordsSearchForm.submit()})},this.showStat=function(e){c.popup(".statPopup?recordId="+e,{})},this.formatTTL=function(e){return e%86400==0?e/86400+"天":e%3600==0?e/3600+"小时":e%60==0?e/60+"分钟":e+"秒"}}const Z={key:0},ee={__name:"NSRouteSelector",props:["v-route-code"],setup(c){const f=L("$Tea"),e=c,{routeCode:_,routes:p}=function(){let t=e.vRouteCode;return t==null&&(t=""),{routeCode:k(t),routes:k([])}}();return A(()=>{f.action("/ns/routes/options").post().success(function(t){p.value=t.data.routes})}),(t,d)=>(i(),l("div",null,[s(p).length>0?(i(),l("div",Z,[n(U,{name:"routeCode",modelValue:s(_),"onUpdate:modelValue":d[0]||(d[0]=h=>F(_)?_.value=h:null)},{default:o(()=>[n(T,{value:""},{default:o(()=>[r("[线路]")]),_:1}),(i(!0),l($,null,R(s(p),h=>(i(),b(T,{value:h.code},{default:o(()=>[r(m(h.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])])):u("",!0)]))}},te=["href"],C={__name:"SortArrow",props:["name"],setup(c){const f=c,{order:e,url:_,iconTitle:p}=function(){let t=window.location.toString(),d="",h="",g=[];window.location.search!=null&&window.location.search.length>0&&window.location.search.substring(1).split("&").forEach(function(w){let x=w.indexOf("=");if(x>0){let N=w.substring(0,x),V=w.substring(x+1);N==f.name?d=V:N!="page"&&V!="asc"&&V!="desc"&&g.push(w)}else g.push(w)}),d=="asc"?(g.push(f.name+"=desc"),h="当前正序排列"):d=="desc"?(g.push(f.name+"=asc"),h="当前倒序排列"):(g.push(f.name+"=desc"),h="当前正序排列");let I=t.indexOf("?");return I>0?t=t.substring(0,I)+"?"+g.join("&"):t=t+"?"+g.join("&"),{order:k(d),url:k(t),iconTitle:k(h)}}();return(t,d)=>{const h=q("tooltip");return z((i(),l("a",{href:s(_)},[a("i",{class:B(["pi small",{"pi-arrow-down":s(e)=="asc","pi-arrow-up":s(e)=="desc","pi-arrow-down grey":s(e)==""||s(e)==null}])},null,2)],8,te)),[[h,s(p),void 0,{top:!0}]])}}},se=["value"],oe={class:"ui fields inline"},ae={class:"ui field"},ne={class:"ui field"},ie={class:"ui field"},re={class:"ui field"},le={key:1,class:"mt-4"},ce={key:2,class:"mt-4"},de={class:"flex items-center gap-2"},ue={key:0},pe={key:0,class:"grey small"},me={key:1,class:"grey small"},_e={key:2,class:"grey small"},he={class:"flex items-center gap-2"},fe=a("div",null," 记录值 ",-1),ye={class:"flex items-center gap-2"},ve=a("div",null," 线路 ",-1),ge={class:"label-group"},ke={key:0},we={key:0},be={key:0,title:"在线"},Ce=a("i",{class:"icon green circle small"},null,-1),$e=a("span",{class:"status green"},"在线",-1),Te={key:1,title:"离线"},xe=a("i",{class:"icon red circle small"},null,-1),Ve=a("span",{class:"status red"},"离线",-1),Se={key:1,class:"disabled"},Re=a("i",{class:"icon circle small"},null,-1),Ie=[Re],Ne=a("br",null,null,-1),Oe=["onClick"],Ue={key:2},Ae=["onClick"],Fe=a("div",null,[r(" 解析次数"),a("br"),a("span",{class:"grey"},"当前小时内")],-1),Le=["onClick"],qe=a("i",{class:"icon chart area small"},null,-1),ze=[qe],Be={key:0},Pe={key:1,class:"disabled"},De=a("div",null," 状态 ",-1),Ke=a("div",null," 操作 ",-1),Me=["onClick"],We=["onClick"],At={__name:"index",setup(c){const f=k(),e=D(new Y,{refs:{recordsSearchForm:f}});return(_,p)=>(i(),l($,null,[n(X,{ctx:s(e),activeTab:"record"},null,8,["ctx"]),n(J,null,{default:o(()=>[n(Q,{onClick:v(s(e).createRecord,["prevent"]),"action-create":""},{default:o(()=>[r("创建记录")]),_:1},8,["onClick"])]),_:1}),a("form",{method:"get",action:"/ns/domains/records",ref_key:"recordsSearchForm",ref:f},[a("input",{type:"hidden",name:"domainId",value:s(e).domain.id},null,8,se),a("div",oe,[a("div",ae,[n(U,{name:"type",modelValue:s(e).type,"onUpdate:modelValue":p[0]||(p[0]=t=>s(e).type=t)},{default:o(()=>[n(T,{value:""},{default:o(()=>[r("[记录类型]")]),_:1}),(i(!0),l($,null,R(s(e).types,t=>(i(),b(T,{value:t.type},{default:o(()=>[r(m(t.type),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),a("div",ne,[n(ee,{"v-route-code":s(e).routeCode},null,8,["v-route-code"])]),a("div",ie,[n(K,{placeholder:"记录名、备注...",name:"keyword",modelValue:s(e).keyword,"onUpdate:modelValue":p[1]||(p[1]=t=>s(e).keyword=t),style:{width:"20em"}},null,8,["modelValue"])]),a("div",re,[n(M,{secondary:"",type:"submit"},{default:o(()=>[r("搜索")]),_:1})])])],512),s(e).records.length==0?(i(),b(G,{key:0},{default:o(()=>[r("暂时还没有记录。")]),_:1})):u("",!0),s(e).enableNameSearch||s(e).enableValueSearch?(i(),l("div",le,[s(e).enableNameSearch?(i(),l("a",{key:0,href:"",onClick:p[2]||(p[2]=v(t=>s(e).searchWithName(s(e).searchingKeyword),["prevent"]))},[n(O,{outlined:""},{default:o(()=>[r('使用name:"'+m(s(e).searchingKeyword)+'"精确搜索',1)]),_:1})])):u("",!0),s(e).enableValueSearch?(i(),l("a",{key:1,href:"",onClick:p[3]||(p[3]=v(t=>s(e).searchWithValue(s(e).searchingKeyword),["prevent"]))},[n(O,null,{default:o(()=>[r('使用value:"'+m(s(e).searchingKeyword)+'"精确搜索',1)]),_:1})])):u("",!0)])):u("",!0),s(e).records.length>0?(i(),l("div",ce,[n(H,{items:s(e).records},{default:o(()=>[n(s(y),{class:"title-column","header-class":"!align-top",frozen:""},{header:o(()=>[a("div",de,[r(" 记录名 "),n(C,{name:"nameOrder"})])]),body:o(({data:t})=>[n(S,{"v-word":s(e).keyword},{default:o(()=>[r(m(t.name)+" ",1)]),_:2},1032,["v-word"]),t.description!=null&&t.description.length>0||t.weight>0||t.type=="MX"?(i(),l("div",ue,[t.description!=null&&t.description.length>0?(i(),l("span",pe,[n(S,{"v-word":s(e).keyword},{default:o(()=>[r(m(t.description),1)]),_:2},1032,["v-word"])])):u("",!0),t.type=="MX"?(i(),l("span",me,"优先级："+m(t.mxPriority),1)):u("",!0),t.weight>0?(i(),l("span",_e,"权重："+m(t.weight),1)):u("",!0)])):u("",!0)]),_:1}),n(s(y),{class:"name-column","header-class":"!align-top"},{header:o(()=>[a("div",he,[r(" 记录类型 "),n(C,{name:"typeOrder"})])]),body:o(({data:t})=>[r(m(t.type),1)]),_:1}),n(s(y),{class:"name-column","header-class":"!align-top"},{header:o(()=>[fe]),body:o(({data:t})=>[n(S,{"v-word":s(e).keyword},{default:o(()=>[r(m(t.value),1)]),_:2},1032,["v-word"])]),_:1}),n(s(y),{class:"value-column","header-class":"!align-top"},{header:o(()=>[a("div",ye,[r(" TTL "),n(C,{name:"ttlOrder"})])]),body:o(({data:t})=>[r(m(s(e).formatTTL(t.ttl)),1)]),_:1}),n(s(y),{class:"name-column","header-class":"!align-top"},{header:o(()=>[ve]),body:o(({data:t})=>[a("div",ge,[(i(!0),l($,null,R(t.routes,d=>(i(),b(E,{outlined:""},{default:o(()=>[r(m(d.name),1)]),_:2},1024))),256))])]),_:1}),s(e).domainHealthCheckIsOn?(i(),b(s(y),{key:0,class:"value-column","header-class":"!align-top"},{header:o(()=>[a("div",null,[r(" 健康检查 "),n(C,{name:"upOrder"})])]),body:o(({data:t})=>[t.type=="A"||t.type=="AAAA"?(i(),l("div",ke,[t.healthCheck.isOn?(i(),l("span",we,[t.isUp?(i(),l("span",be,[Ce,r(" "),$e])):u("",!0),t.isUp?u("",!0):(i(),l("span",Te,[xe,r(" "),Ve]))])):(i(),l("span",Se,Ie)),Ne,a("a",{href:"",style:{"font-size":"0.9em","margin-top":"0.12em"},onClick:v(d=>s(e).updateRecordHealthCheck(t.id),["prevent"])},"[设置]",8,Oe),t.isUp?u("",!0):(i(),l("span",Ue,[r("  "),a("a",{href:"",onClick:v(d=>s(e).upRecord(t),["prevent"])},"[上线]",8,Ae)]))])):u("",!0)]),_:1})):u("",!0),n(s(y),{class:"value-column","header-class":"!align-top"},{header:o(()=>[Fe]),body:o(({data:t})=>[a("a",{href:"",onClick:v(d=>s(e).showStat(t.id),["prevent"]),title:"查看统计"},ze,8,Le),r("  "),t.stat.countRequests>0?(i(),l("span",Be,m(t.stat.countRequestsFormat),1)):(i(),l("span",Pe,"-"))]),_:1}),n(s(y),{class:"status-column","header-class":"!align-top"},{header:o(()=>[De]),body:o(({data:t})=>[n(W,{"v-is-on":t.isOn},null,8,["v-is-on"])]),_:1}),n(s(y),{class:"two op","header-class":"!align-top",frozen:"","align-frozen":"right"},{header:o(()=>[Ke]),body:o(({data:t})=>[a("a",{href:"",onClick:v(d=>s(e).updateRecord(t.id),["prevent"])},"修改",8,Me),r("   "),a("a",{href:"",onClick:v(d=>s(e).deleteRecord(t.id),["prevent"])},"删除",8,We)]),_:1})]),_:1},8,["items"]),n(j,{data:s(e).page},null,8,["data"])])):u("",!0)],64))}};export{At as default};
