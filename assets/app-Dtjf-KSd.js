import{r as m,o,g as s,a as e,u as l,F as Q,D as W,c as we,w as d,h as r,t as z,f as n,i as f,b as u,L as Be,d as L,e as M,bb as R,a_ as T,n as J}from"./app-BYx064nO.js";import{u as $e}from"./app-DISTCiac.js";import{_ as X}from"./app-C5GVF480.js";import{T as y}from"./app-DR284fT9.js";import{C as O}from"./app-IrmNFWm4.js";import{_ as j}from"./app-BrIVTM_6.js";import{_ as ze,a as ce}from"./app-BuHt2kYS.js";import{_ as K}from"./app--BlRpVz_.js";import{T as de}from"./app-DNadG4GC.js";import{_ as pe}from"./app-DfipPP5d.js";import{D as S}from"./app-D0jdtzyy.js";const Oe=["value"],Ke={key:0,class:"label-group"},Se={key:0,class:"red"},Ue={key:1},Ae={key:2},Fe={key:3},Ne={key:4},Ee={key:5},Le={key:6},Me={key:0},Je={key:1},je={key:2},qe={key:3},Ge={key:4,class:"grey"},He={key:0},Qe={key:1},We=["onClick"],Xe=e("i",{class:"pi pi-remove small"},null,-1),Ye=[Xe],Ze={key:1},et={style:{"margin-bottom":"1em"}},tt=e("td",{class:"title"},"开始IP *",-1),nt=e("td",null,"结束IP *",-1),lt=e("td",null,"排除",-1),ot=e("p",{class:"comment"},"选中后表示线路中排除当前条件。",-1),st=e("i",{class:"pi pi-remove small"},null,-1),at=[st],ut={style:{"margin-bottom":"1em"}},it=e("td",{class:"title"},"IP范围列表 *",-1),rt={class:"comment"},ct=e("td",null,"排除",-1),dt=e("p",{class:"comment"},"选中后表示线路中排除当前条件。",-1),pt=e("i",{class:"pi pi-remove small"},null,-1),ft=[pt],mt={key:0},_t={key:2},vt={style:{"margin-bottom":"1em"}},yt=e("td",{class:"title"},"CIDR *",-1),ht={class:"comment"},Rt=e("td",null,"排除",-1),gt=e("p",{class:"comment"},"选中后表示线路中排除当前条件。",-1),kt=e("i",{class:"pi pi-remove small"},null,-1),Ct=[kt],It={style:{"margin-bottom":"1em"}},bt=e("td",{class:"title"},"IP范围列表 *",-1),Pt={class:"comment"},Vt=e("td",null,"排除",-1),Dt=e("p",{class:"comment"},"选中后表示线路中排除当前条件。",-1),xt=e("i",{class:"pi pi-remove small"},null,-1),Tt=[xt],wt={key:0},Bt={key:3},$t={key:0},zt=e("td",null,"已添加",-1),Ot={class:"label-group"},Kt={key:0},St={key:1},Ut={key:2},At={key:3},Ft=["onClick"],Nt=e("i",{class:"pi pi-remove small"},null,-1),Et=[Nt],Lt={key:0,class:"grey"},Mt={key:0},Jt={key:1},jt={class:"title"},qt={key:0},Gt={key:1},Ht={key:2},Qt={key:3},Wt={key:0},Xt={key:1},Yt={key:2},Zt={key:3},en={style:{"margin-top":"1em"}},tn=e("td",null,"区域之间关系",-1),nn={key:0,class:"comment"},ln={key:1,class:"comment"},on=e("td",null,"排除",-1),sn=e("p",{class:"comment"},"选中后表示线路中排除当前条件。",-1),an=e("i",{class:"pi pi-remove small"},null,-1),un=[an],rn={key:1},Cn={__name:"NSRouteRangesBox",props:["v-ranges"],setup(fe,{expose:me}){const b=$e(),_e=fe,{ranges:C,isAdding:h,isAddingBatch:I,rangeType:U,isReverse:p,ipRangeFrom:P,ipRangeTo:V,batchIPRange:w,ipCIDR:D,batchIPCIDR:B,regions:g,regionType:v,regionConnector:k}=function(){let a=_e.vRanges;return a==null&&(a=[]),{ranges:m(a),isAdding:m(!1),isAddingBatch:m(!1),rangeType:m("ipRange"),isReverse:m(!1),ipRangeFrom:m(""),ipRangeTo:m(""),batchIPRange:m(""),ipCIDR:m(""),batchIPCIDR:m(""),regions:m([]),regionType:m("country"),regionConnector:m("OR")}}(),A=m(),q=m(),Y=m(),F=m(),N=m(),Z=m(),ee=m(),te=m(),ne=m(),ve=function(){h.value=!0,setTimeout(function(){q.value.focus()},100)},ye=function(){h.value=!0,setTimeout(function(){A.value.focus()},100)},he=function(){h.value=!0},E=function(a){v.value=a},Re=function(a){C.value.$remove(a)},le=function(){h.value=!1,P.value="",V.value="",p.value=!1},oe=function(){h.value=!1,D.value="",p.value=!1},G=function(){h.value=!1,g.value=[],v.value="country",k.value="OR",p.value=!1},H=function(){if(P.value=P.value.trim(),!$(P.value)){b.warn("开始IP填写错误",function(){q.value.focus()});return}if(V.value=V.value.trim(),!$(V.value)){b.warn("结束IP填写错误",function(){Y.value.focus()});return}C.value.push({type:"ipRange",params:{ipFrom:P.value,ipTo:V.value,isReverse:p.value}}),le()},se=function(){if(D.value.length==0){b.warn("请填写CIDR",function(){A.value.focus()});return}if(!ie(D.value)){b.warn("请输入正确的CIDR",function(){A.value.focus()});return}C.value.push({type:"cidr",params:{cidr:D.value,isReverse:p.value}}),oe()},ge=function(){if(g.value.length==0){G();return}C.value.push({type:"region",connector:k.value,params:{regions:g.value,isReverse:p.value}}),G()},ke=function(){I.value=!0,setTimeout(function(){F.value.focus()},100)},Ce=function(){I.value=!0,setTimeout(function(){N.value.focus()},100)},ae=function(){I.value=!1,w.value="",p.value=!1},ue=function(){I.value=!1,B.value="",p.value=!1},Ie=function(){let a=w.value;if(a.length==0){b.warn("请填写要加入的IP范围",function(){F.value.focus()});return}let i=[],t="";if(a.split(`
`).forEach(function(c){if(c=c.trim(),c.length==0)return;c=c.replace("，",",");let _=c.split(",");if(_.length!=2){t=c;return}let x=_[0].trim(),re=_[1].trim();if(!$(x)||!$(re)){t=c;return}i.push({type:"ipRange",params:{ipFrom:x,ipTo:re,isReverse:p.value}})}),t.length>0){b.warn("'"+t+"'格式错误",function(){F.value.focus()});return}i.forEach(function(c){C.value.push(c)}),ae()},be=function(){let a=B.value;if(a.length==0){b.warn("请填写要加入的CIDR",function(){N.value.focus()});return}let i=[],t="";if(a.split(`
`).forEach(function(c){let _=c.trim();if(_.length!=0){if(!ie(_)){t=c;return}i.push({type:"cidr",params:{cidr:_,isReverse:p.value}})}}),t.length>0){b.warn("'"+t+"'格式错误",function(){N.focus()});return}i.forEach(function(c){C.value.push(c)}),ue()},Pe=function(a){a!=null&&(g.value.push({type:"country",id:a.id,name:a.name}),Z.value.clear())},Ve=function(a){a!=null&&(g.value.push({type:"province",id:a.id,name:a.name}),te.value.clear())},De=function(a){a!=null&&(g.value.push({type:"city",id:a.id,name:a.name}),ee.value.clear())},xe=function(a){a!=null&&(g.value.push({type:"provider",id:a.id,name:a.name}),ne.value.clear())},Te=function(a){g.value.$remove(a)},$=function(a){if(a.length==0)return;if(a.indexOf(":")>=0){let c=a.split(":");if(c.length>8)return!1;let _=!0;return c.forEach(function(x){/^[\da-fA-F]{0,4}$/.test(x)||(_=!1)}),_}if(!a.match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/))return!1;let i=a.split("."),t=!0;return i.forEach(function(c){parseInt(c)>255&&(t=!1)}),t},ie=function(a){let i=a.split("/");if(i.length!=2)return!1;let t=i[0];if(!$(t))return!1;let c=i[1];return/^\d{1,3}$/.test(c)?(c=parseInt(c,10),a.indexOf(":")>=0?c<=128:c<=32):!1};return me({updateRangeType:function(a){U.value=a}}),(a,i)=>(o(),s("div",null,[e("input",{type:"hidden",name:"rangesJSON",value:JSON.stringify(l(C))},null,8,Oe),l(C).length>0?(o(),s("div",Ke,[(o(!0),s(Q,null,W(l(C),(t,c)=>(o(),we(de,{outlined:""},{default:d(()=>[t.params.isReverse?(o(),s("span",Se,"[排除]")):r("",!0),t.type=="ipRange"?(o(),s("span",Ue,"IP范围：")):r("",!0),t.type=="cidr"?(o(),s("span",Ae,"CIDR：")):r("",!0),t.type=="region"?(o(),s("span",Fe)):r("",!0),t.type=="ipRange"?(o(),s("span",Ne,z(t.params.ipFrom)+" - "+z(t.params.ipTo),1)):r("",!0),t.type=="cidr"?(o(),s("span",Ee,z(t.params.cidr),1)):r("",!0),t.type=="region"?(o(),s("span",Le,[(o(!0),s(Q,null,W(t.params.regions,(_,x)=>(o(),s("span",null,[_.type=="country"?(o(),s("span",Me,"国家/地区")):r("",!0),_.type=="province"?(o(),s("span",Je,"省份")):r("",!0),_.type=="city"?(o(),s("span",je,"城市")):r("",!0),_.type=="provider"?(o(),s("span",qe,"ISP")):r("",!0),n(" ："+z(_.name)+" ",1),x<t.params.regions.length-1?(o(),s("span",Ge,[n("   "),t.connector=="OR"||t.connector==""||t.connector==null?(o(),s("span",He,"或")):r("",!0),t.connector=="AND"?(o(),s("span",Qe,"且")):r("",!0),n("   ")])):r("",!0)]))),256))])):r("",!0),n("   "),e("a",{href:"",title:"删除",onClick:f(_=>Re(c),["prevent"])},Ye,8,We)]),_:2},1024))),256)),u(Be)])):r("",!0),l(U)=="ipRange"?(o(),s("div",Ze,[L(e("div",et,[u(S,null,{default:d(()=>[e("tbody",null,[e("tr",null,[tt,e("td",null,[u(X,{type:"text",placeholder:"开始IP",maxlength:"40",size:"40",style:{width:"15em"},modelValue:l(P),"onUpdate:modelValue":i[0]||(i[0]=t=>R(P)?P.value=t:null),ref_key:"ipRangeFromRef",ref:q,onKeyup:T(H,["enter"]),onKeypress:T(f(t=>1,["prevent"]),["enter"]),class:"font-normal"},null,8,["modelValue","onKeypress"])])]),e("tr",null,[nt,e("td",null,[u(X,{type:"text",placeholder:"结束IP",maxlength:"40",size:"40",style:{width:"15em"},modelValue:l(V),"onUpdate:modelValue":i[1]||(i[1]=t=>R(V)?V.value=t:null),ref_key:"ipRangeToRef",ref:Y,onKeyup:T(H,["enter"]),onKeypress:T(f(t=>1,["prevent"]),["enter"]),class:"font-normal"},null,8,["modelValue","onKeypress"])])]),e("tr",null,[lt,e("td",null,[u(K,{modelValue:l(p),"onUpdate:modelValue":i[2]||(i[2]=t=>R(p)?p.value=t:null)},null,8,["modelValue"]),ot])])])]),_:1}),u(y,{secondary:"",size:"small",type:"button",onClick:f(H,["prevent"])},{default:d(()=>[n("确定")]),_:1}),n("   "),e("a",{href:"",onClick:f(le,["prevent"]),title:"取消"},at)],512),[[M,l(h)]]),L(e("div",ut,[u(S,null,{default:d(()=>[e("tbody",null,[e("tr",null,[it,e("td",null,[u(pe,{rows:"5",ref_key:"batchIPRangeRef",ref:F,modelValue:l(w),"onUpdate:modelValue":i[3]||(i[3]=t=>R(w)?w.value=t:null),class:"w-full font-normal"},null,8,["modelValue"]),e("p",rt,[n("每行一条，格式为 "),u(O,null,{default:d(()=>[n("开始IP,结束IP")]),_:1}),n(" ，比如 "),u(O,null,{default:d(()=>[n("192.168.1.100,192.168.1.200")]),_:1}),n(" 。 ")])])]),e("tr",null,[ct,e("td",null,[u(K,{modelValue:l(p),"onUpdate:modelValue":i[4]||(i[4]=t=>R(p)?p.value=t:null)},null,8,["modelValue"]),dt])])])]),_:1}),u(y,{secondary:"",size:"small",type:"button",onClick:f(Ie,["prevent"])},{default:d(()=>[n("确定")]),_:1}),n("   "),e("a",{href:"",onClick:f(ae,["prevent"]),title:"取消"},ft)],512),[[M,l(I)]]),!l(h)&&!l(I)?(o(),s("div",mt,[u(y,{secondary:"",size:"small",type:"button",onClick:f(ve,["prevent"])},{default:d(()=>[n("添加单个IP范围")]),_:1}),n("   "),u(y,{secondary:"",size:"small",type:"button",onClick:f(ke,["prevent"])},{default:d(()=>[n("批量添加IP范围")]),_:1})])):r("",!0)])):r("",!0),l(U)=="cidr"?(o(),s("div",_t,[L(e("div",vt,[u(S,null,{default:d(()=>[e("tbody",null,[e("tr",null,[yt,e("td",null,[u(X,{type:"text",placeholder:"IP/MASK",maxlength:"40",size:"40",style:{width:"15em"},modelValue:l(D),"onUpdate:modelValue":i[5]||(i[5]=t=>R(D)?D.value=t:null),ref_key:"ipCIDRRef",ref:A,onKeyup:T(se,["enter"]),onKeypress:T(f(t=>1,["prevent"]),["enter"]),class:"font-normal"},null,8,["modelValue","onKeypress"]),e("p",ht,[n("类似于 "),u(O,null,{default:d(()=>[n("192.168.2.1/24")]),_:1}),n(" 。 ")])])]),e("tr",null,[Rt,e("td",null,[u(K,{modelValue:l(p),"onUpdate:modelValue":i[6]||(i[6]=t=>R(p)?p.value=t:null)},null,8,["modelValue"]),gt])])])]),_:1}),u(y,{secondary:"",size:"small",type:"button",onClick:f(se,["prevent"])},{default:d(()=>[n("确定")]),_:1}),n("   "),e("a",{href:"",onClick:f(oe,["prevent"]),title:"取消"},Ct)],512),[[M,l(h)]]),L(e("div",It,[u(S,null,{default:d(()=>[e("tbody",null,[e("tr",null,[bt,e("td",null,[u(pe,{rows:"5",ref_key:"batchIPCIDRRef",ref:N,modelValue:l(B),"onUpdate:modelValue":i[7]||(i[7]=t=>R(B)?B.value=t:null),class:"w-full font-normal"},null,8,["modelValue"]),e("p",Pt,[n("每行一条，格式为 "),u(O,null,{default:d(()=>[n("IP/MASK")]),_:1}),n(" ，比如 "),u(O,null,{default:d(()=>[n("192.168.2.1/24")]),_:1}),n(" 。 ")])])]),e("tr",null,[Vt,e("td",null,[u(K,{modelValue:l(p),"onUpdate:modelValue":i[8]||(i[8]=t=>R(p)?p.value=t:null)},null,8,["modelValue"]),Dt])])])]),_:1}),u(y,{secondary:"",size:"small",type:"button",onClick:f(be,["prevent"])},{default:d(()=>[n("确定")]),_:1}),n("   "),e("a",{href:"",onClick:f(ue,["prevent"]),title:"取消"},Tt)],512),[[M,l(I)]]),!l(h)&&!l(I)?(o(),s("div",wt,[u(y,{secondary:"",size:"small",type:"button",onClick:f(ye,["prevent"])},{default:d(()=>[n("添加单个CIDR")]),_:1}),n("   "),u(y,{secondary:"",size:"small",type:"button",onClick:f(Ce,["prevent"])},{default:d(()=>[n("批量添加CIDR")]),_:1})])):r("",!0)])):r("",!0),l(U)=="region"?(o(),s("div",Bt,[l(h)?(o(),s("div",$t,[u(S,null,{default:d(()=>[e("tbody",null,[e("tr",null,[zt,e("td",null,[e("div",Ot,[(o(!0),s(Q,null,W(l(g),(t,c)=>(o(),s("span",null,[u(de,{outlined:""},{default:d(()=>[t.type=="country"?(o(),s("span",Kt,"国家/地区")):r("",!0),t.type=="province"?(o(),s("span",St,"省份")):r("",!0),t.type=="city"?(o(),s("span",Ut,"城市")):r("",!0),t.type=="provider"?(o(),s("span",At,"ISP")):r("",!0),n(" ："+z(t.name)+" ",1),e("a",{href:"",title:"删除",onClick:f(_=>Te(c),["prevent"])},Et,8,Ft)]),_:2},1024),c<l(g).length-1?(o(),s("span",Lt,[n("   "),l(k)=="OR"||l(k)==""?(o(),s("span",Mt,"或")):r("",!0),l(k)=="AND"?(o(),s("span",Jt,"且")):r("",!0),n("   ")])):r("",!0)]))),256))])])]),e("tr",null,[e("td",jt,[n("添加新"),l(v)=="country"?(o(),s("span",qt,"国家/地区")):r("",!0),l(v)=="province"?(o(),s("span",Gt,"省份")):r("",!0),l(v)=="city"?(o(),s("span",Ht,"城市")):r("",!0),l(v)=="provider"?(o(),s("span",Qt,"ISP")):r("",!0),n(" * ")]),e("td",null,[l(v)=="country"?(o(),s("div",Wt,[u(j,{title:"",width:"14em","data-url":"/ui/countryOptions","data-key":"countries",placeholder:"点这里选择国家/地区",onChange:Pe,ref_key:"regionCountryComboBoxRef",ref:Z,key:"combo-box-country"},null,512)])):r("",!0),l(v)=="province"?(o(),s("div",Xt,[u(j,{title:"","data-url":"/ui/provinceOptions","data-key":"provinces",placeholder:"点这里选择省份",onChange:Ve,ref_key:"regionProvinceComboBoxRef",ref:te,key:"combo-box-province"},null,512)])):r("",!0),l(v)=="city"?(o(),s("div",Yt,[u(j,{title:"","data-url":"/ui/cityOptions","data-key":"cities",placeholder:"点这里选择城市",onChange:De,ref_key:"regionCityComboBoxRef",ref:ee,key:"combo-box-city"},null,512)])):r("",!0),l(v)=="provider"?(o(),s("div",Zt,[u(j,{title:"","data-url":"/ui/providerOptions","data-key":"providers",placeholder:"点这里选择ISP",onChange:xe,ref_key:"regionProviderComboBoxRef",ref:ne,key:"combo-box-isp"},null,512)])):r("",!0),e("div",en,[u(y,{secondary:"",size:"small",class:J({blue:l(v)=="country"}),type:"button",onClick:i[9]||(i[9]=f(t=>E("country"),["prevent"]))},{default:d(()=>[n("添加国家/地区")]),_:1},8,["class"]),n("   "),u(y,{secondary:"",size:"small",class:J({blue:l(v)=="province"}),type:"button",onClick:i[10]||(i[10]=f(t=>E("province"),["prevent"]))},{default:d(()=>[n("添加省份")]),_:1},8,["class"]),n("   "),u(y,{secondary:"",size:"small",class:J({blue:l(v)=="city"}),type:"button",onClick:i[11]||(i[11]=f(t=>E("city"),["prevent"]))},{default:d(()=>[n("添加城市")]),_:1},8,["class"]),n("   "),u(y,{secondary:"",size:"small",class:J({blue:l(v)=="provider"}),type:"button",onClick:i[12]||(i[12]=f(t=>E("provider"),["prevent"]))},{default:d(()=>[n("ISP")]),_:1},8,["class"]),n("   ")])])]),e("tr",null,[tn,e("td",null,[u(ze,{modelValue:l(k),"onUpdate:modelValue":i[13]||(i[13]=t=>R(k)?k.value=t:null)},{default:d(()=>[u(ce,{value:"OR"},{default:d(()=>[n("或")]),_:1}),u(ce,{value:"AND"},{default:d(()=>[n("且")]),_:1})]),_:1},8,["modelValue"]),l(k)=="OR"?(o(),s("p",nn,"匹配所选任一区域即认为匹配成功。")):r("",!0),l(k)=="AND"?(o(),s("p",ln,"匹配所有所选区域才认为匹配成功。")):r("",!0)])]),e("tr",null,[on,e("td",null,[u(K,{modelValue:l(p),"onUpdate:modelValue":i[14]||(i[14]=t=>R(p)?p.value=t:null)},null,8,["modelValue"]),sn])])])]),_:1}),u(y,{secondary:"",size:"small",type:"button",onClick:f(ge,["prevent"])},{default:d(()=>[n("确定")]),_:1}),n("   "),e("a",{href:"",onClick:f(G,["prevent"]),title:"取消"},un)])):r("",!0),!l(h)&&!l(I)?(o(),s("div",rn,[u(y,{secondary:"",size:"small",type:"button",onClick:f(he,["prevent"])},{default:d(()=>[n("添加区域")]),_:1}),n("   ")])):r("",!0)])):r("",!0)]))}};export{Cn as _};
