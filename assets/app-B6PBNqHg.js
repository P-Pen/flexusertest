import{o as s,g as l,a as i,b as r,w as u,u as e,F as g,L as v,h as a,t as h,c as p,i as f,f as c}from"./app-BYx064nO.js";import{i as k,c as w}from"./app-DISTCiac.js";import{_ as F}from"./app-_N2IGwgj.js";import{_ as b}from"./app-C5GVF480.js";import{T as y}from"./app-DR284fT9.js";import{T as _}from"./app-BXiLqtxA.js";import{_ as S}from"./app-57xpzLDR.js";import{D as N}from"./app-D0jdtzyy.js";import{_ as x}from"./app-5V9SnxW6.js";import"./app-DYkSpHuE.js";import"./app-CqvvE0jO.js";import"./app-CK9Tk_hc.js";import"./app-CAeEyuA3.js";import"./app-DoRtcMJm.js";import"./app-DPMEyUYH.js";import"./app-DOaxShSm.js";function V(){const{utils:d,Tea:t}=k(this);this.frontPreviewURL="",this.isSubmitting=!1,this.realName="",this.number="",this.identity!=null&&(this.realName=this.identity.realName,this.number=this.identity.number),this.canEdit=this.identity==null||this.identity.status=="none"||this.identity.status=="rejected",this.selectFile=function(m){document.getElementById(m).click()},this.changeFrontFile=function(m){let n=m.target.files;n.length>0&&(this.frontPreviewURL=URL.createObjectURL(n[0]))},this.beforeSubmit=function(){this.isSubmitting=!0},this.doneSubmit=function(){this.isSubmitting=!1},this.success=function(){d.success("保存成功",function(){d.reload()})},this.submit=function(){if(this.identity==null){d.fail("请先保存后再提交审核");return}this.$post(".submit").params({identityId:this.identity.id}).success(function(){d.success("提交成功",function(){d.reload()})})},this.cancel=function(){if(this.identity==null){d.fail("请先保存后再提交审核");return}d.confirm("确定要取消提交审核吗？",function(){this.$post(".cancel").params({identityId:this.identity.id}).success(function(){d.success("取消成功",function(){d.reload()})})})}}const B=["value"],C=i("td",{class:"title"},"企业全称 *",-1),R={key:0},U={key:1},L=i("td",null,"营业执照号码 *",-1),$={key:0},E={key:1},I=i("td",null,[c("营业执照照片 *"),i("em",null,"不超过8MiB")],-1),T={class:"idcard-bg"},j=["src"],D=["src"],P=i("i",{class:"icon plus"},null,-1),M=i("p",{class:"comment"},"请上传高清营业执照正、副本照片以便于系统识别。",-1),O={key:1},q={key:0},z={key:0},A={class:"mt-4"},G={key:1},H={class:"mt-4"},J={key:2},K={class:"mt-4"},Q={key:3},W={key:2},ft={__name:"enterprise",setup(d){const t=w(new V);return(m,n)=>(s(),l(g,null,[i("div",null,[r(x,{class:"!pt-0",items:[{label:"实名认证",url:"/settings/identity"},{label:"企业实名认证"}]}),r(v,{class:"!mt-0"})]),r(F,{action:".uploadEnterprise",timeout:"600",onBefore:e(t).beforeSubmit,onDone:e(t).doneSubmit,onSuccess:e(t).success},{default:u(()=>[e(t).identity!=null?(s(),l("input",{key:0,type:"hidden",name:"identityId",value:e(t).identity.id},null,8,B)):a("",!0),r(N,null,{default:u(()=>[i("tbody",null,[i("tr",null,[C,i("td",null,[e(t).canEdit?(s(),l("div",R,[r(b,{name:"realName",placeholder:"企业全称",maxlength:"100",style:{width:"20em"},autofocus:"",modelValue:e(t).realName,"onUpdate:modelValue":n[0]||(n[0]=o=>e(t).realName=o)},null,8,["modelValue"])])):(s(),l("div",U,h(e(t).identity.realName),1))])]),i("tr",null,[L,i("td",null,[e(t).canEdit?(s(),l("div",$,[r(b,{name:"number",placeholder:"营业执照号码",maxlength:"18",style:{width:"20em"},modelValue:e(t).number,"onUpdate:modelValue":n[1]||(n[1]=o=>e(t).number=o)},null,8,["modelValue"])])):(s(),l("div",E,h(e(t).identity.number),1))])]),i("tr",null,[I,i("td",null,[i("input",{type:"file",name:"frontFile",id:"front-file",accept:"image/jpeg, image/png",onChange:n[2]||(n[2]=(...o)=>e(t).changeFrontFile&&e(t).changeFrontFile(...o))},null,32),i("div",T,[e(t).identity!=null&&e(t).identity.frontFileId>0&&e(t).frontPreviewURL.length==0?(s(),l("img",{key:0,src:"/files/file?fileId="+e(t).identity.frontFileId,alt:""},null,8,j)):a("",!0),e(t).frontPreviewURL.length>0?(s(),l("img",{key:1,src:e(t).frontPreviewURL,alt:""},null,8,D)):a("",!0),e(t).canEdit?(s(),p(y,{key:2,secondary:"",onClick:n[3]||(n[3]=f(o=>e(t).selectFile("front-file"),["prevent"]))},{default:u(()=>[P]),_:1})):a("",!0)]),M])])])]),_:1}),e(t).isSubmitting?a("",!0):(s(),l("div",O,[i("div",null,[e(t).identity==null?(s(),p(S,{key:0},{default:u(()=>[c("保存")]),_:1})):a("",!0)]),e(t).identity!=null?(s(),l("div",q,[e(t).identity.status=="none"?(s(),l("div",z,[r(_,{warning:""},{default:u(()=>[c("已上传，请提交审核。")]),_:1}),i("div",A,[r(y,{type:"submit"},{default:u(()=>[c("保存修改")]),_:1}),c("     "),i("a",{href:"",onClick:n[4]||(n[4]=f((...o)=>e(t).submit&&e(t).submit(...o),["prevent"])),class:"link"},"提交审核")])])):a("",!0),e(t).identity.status=="submitted"?(s(),l("div",G,[r(_,{warning:""},{default:u(()=>[c("管理员审核中，请耐心等待。")]),_:1}),i("div",H,[i("a",{href:"",class:"link",onClick:n[5]||(n[5]=f((...o)=>e(t).cancel&&e(t).cancel(...o),["prevent"]))},"取消审核")])])):a("",!0),e(t).identity.status=="rejected"?(s(),l("div",J,[r(_,{error:""},{default:u(()=>[c("审核不通过，原因："+h(e(t).identity.rejectReason)+"。",1)]),_:1}),i("div",K,[r(y,{secondary:"",type:"submit"},{default:u(()=>[c("保存修改")]),_:1}),c("     "),i("a",{href:"",class:"link",onClick:n[6]||(n[6]=f((...o)=>e(t).submit&&e(t).submit(...o),["prevent"]))},"重新提交审核")])])):a("",!0),e(t).identity.status=="verified"?(s(),l("div",Q,[r(_,{success:""},{default:u(()=>[c("实名认证审核通过。")]),_:1})])):a("",!0)])):a("",!0)])),e(t).isSubmitting?(s(),l("div",W," 正在提交，请稍候... ")):a("",!0)]),_:1},8,["onBefore","onDone","onSuccess"])],64))}};export{ft as default};
