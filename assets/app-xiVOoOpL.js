import{o as D,c as P,w as i,b as n,a as e,u as l,f as o,t as x,d as p,e as r,i as d,n as T,L as v}from"./app-BYx064nO.js";import{P as N}from"./app-BnDFQ2zy.js";import{i as w,c as U}from"./app-DISTCiac.js";import{_ as R}from"./app-_N2IGwgj.js";import{_ as u}from"./app-C5GVF480.js";import{_ as b}from"./app-Blp_4b-h.js";import{C as f}from"./app-IrmNFWm4.js";import{_}from"./app-e1i_B4SR.js";import{_ as A,a as c}from"./app-BuHt2kYS.js";import{_ as $}from"./app-1SA4suwN.js";import{_ as L}from"./app-CryyhHYs.js";import{_ as B}from"./app-CbPWpFKs.js";import{_ as C}from"./app--BlRpVz_.js";import{_ as q}from"./app-57xpzLDR.js";import{T as y,a as h}from"./app-DRGtcCVV.js";import{D as O}from"./app-D0jdtzyy.js";import{_ as V}from"./app-Bg2kbTeB.js";import{_ as g}from"./app-x_fVWXrx.js";import"./app-GoR2fTOd.js";import"./app-DYkSpHuE.js";import"./app-DR284fT9.js";import"./app-DNadG4GC.js";import"./app-DPMEyUYH.js";import"./app-DGM5HqRo.js";import"./app-51hQc1Cd.js";import"./app-CqAVEB_b.js";import"./app-CK9Tk_hc.js";import"./app-Cqxz9tud.js";import"./app-DoRtcMJm.js";import"./app-aIb4ksxL.js";import"./app-DyIe33QU.js";import"./app-TBcc1obG.js";import"./app-DfipPP5d.js";import"./app-tUtHmy3n.js";function I(){w(this),this.success=this.$NotifyPopup,this.type=this.policy.type,this.authDescription="",this.rawDescription="",this.$delay(function(){this.changeType()}),this.changeType=function(){let m=this,t=this.authTypes.$find(function(S,a){return a.code==m.type});t!=null?(this.policy.typeName=t.name,this.authDescription=t.description,this.rawDescription=t.description):(this.authDescription="",this.rawDescription="")},this.typeASecret="",this.typeASignParamName="sign",this.policy.type=="typeA"&&(this.typeASecret=this.policy.params.secret,this.typeASignParamName=this.policy.params.signParamName,this.$delay(function(){this.changeTypeASignParamName()})),this.generateTypeASecret=function(){this.$post(".random").success(function(m){this.typeASecret=m.data.random})},this.changeTypeASignParamName=function(){this.authDescription=this.rawDescription.replace("sign=",this.typeASignParamName+"=")},this.typeBSecret="",this.policy.type=="typeB"&&(this.typeBSecret=this.policy.params.secret),this.generateTypeBSecret=function(){this.$post(".random").success(function(m){this.typeBSecret=m.data.random})},this.typeCSecret="",this.policy.type=="typeC"&&(this.typeCSecret=this.policy.params.secret),this.generateTypeCSecret=function(){this.$post(".random").success(function(m){this.typeCSecret=m.data.random})},this.typeDSecret="",this.typeDSignParamName="sign",this.typeDTimestampParamName="t",this.policy.type=="typeD"&&(this.typeDSecret=this.policy.params.secret,this.typeDSignParamName=this.policy.params.signParamName,this.typeDTimestampParamName=this.policy.params.timestampParamName,this.$delay(function(){this.changeTypeDSignParamName(),this.changeTypeDTimestampParamName()})),this.generateTypeDSecret=function(){this.$post(".random").success(function(m){this.typeDSecret=m.data.random})},this.changeTypeDSignParamName=function(){this.authDescription=this.rawDescription.replace("sign=",this.typeDSignParamName+"="),this.authDescription=this.authDescription.replace("t=",this.typeDTimestampParamName+"=")},this.changeTypeDTimestampParamName=function(){this.authDescription=this.rawDescription.replace("sign=",this.typeDSignParamName+"="),this.authDescription=this.authDescription.replace("t=",this.typeDTimestampParamName+"=")},this.moreBasicAuthOptionsVisible=!1,this.showMoreBasicAuthOptions=function(){this.moreBasicAuthOptionsVisible=!this.moreBasicAuthOptionsVisible},this.subRequestFollowRequest=this.policy.params.method!=null&&this.policy.params.method.length>0?0:1}const k=e("header",null,"修改鉴权方式",-1),F=["value"],M=["value"],E=["value"],G=e("td",{class:"title"},"名称 *",-1),H=e("td",null,"鉴权类型 *",-1),J=["innerHTML"],z=e("td",null,"鉴权密钥 *",-1),j={class:"comment"},K=e("td",null,"签名参数 *",-1),Q=e("td",null,"有效时间",-1),W=e("span",null,"秒",-1),X=e("p",{class:"comment"},"链接有效时间。",-1),Y=e("td",null,"鉴权密钥 *",-1),Z={class:"comment"},ee=e("td",null,"有效时间",-1),te=e("span",null,"秒",-1),le=e("p",{class:"comment"},"链接有效时间。",-1),ae=e("td",null,"鉴权密钥 *",-1),se={class:"comment"},ne=e("td",null,"有效时间",-1),oe=e("span",null,"秒",-1),ie=e("p",{class:"comment"},"链接有效时间。",-1),ue=e("td",null,"鉴权密钥 *",-1),me={class:"comment"},pe=e("td",null,"签名参数 *",-1),re=e("td",null,"时间戳参数 *",-1),de=e("td",null,"有效时间",-1),ce=e("span",null,"秒",-1),ye=e("p",{class:"comment"},"链接有效时间。",-1),he=e("td",null,"用户 *",-1),fe={colspan:"2"},_e=e("td",null,[o("认证领域名"),e("em",null,"（Realm）")],-1),Ve=e("td",null,"字符集",-1),ge={class:"comment"},Se=e("td",null,"子请求URL *",-1),De=e("p",{class:"comment"},"可以是一个完整的URL，也可以是一个路径。",-1),Pe=e("td",null,"请求方法",-1),xe={style:{"margin-top":"0.8em"}},Te={colspan:"2"},ve=e("td",null,"限定文件扩展名",-1),Ne={class:"comment"},we=e("td",null,"限定域名",-1),Ue=e("p",{class:"comment"},"如果不为空，则表示只有这些域名的文件才需要鉴权。",-1),Re=e("td",null,"启用当前鉴权",-1),pt={__name:"updatePopup",setup(m){const t=U(new I);return(S,a)=>(D(),P(N,null,{default:i(()=>[k,n(R,{action:"$",onSuccess:l(t).success},{default:i(()=>[e("input",{type:"hidden",name:"policyId",value:l(t).policy.id},null,8,F),e("input",{type:"hidden",name:"exceptURLPatternsJSON",value:JSON.stringify(l(t).policy.params.exceptURLPatterns)},null,8,M),e("input",{type:"hidden",name:"onlyURLPatternsJSON",value:JSON.stringify(l(t).policy.params.onlyURLPatterns)},null,8,E),n(O,null,{default:i(()=>[e("tbody",null,[e("tr",null,[G,e("td",null,[n(u,{type:"text",name:"name",maxlength:"50",autofocus:"",modelValue:l(t).policy.name,"onUpdate:modelValue":a[0]||(a[0]=s=>l(t).policy.name=s),class:"w-full"},null,8,["modelValue"])])]),e("tr",null,[H,e("td",null,[o(x(l(t).policy.typeName)+" ",1),e("p",{class:"comment",innerHTML:l(t).authDescription},null,8,J)])])]),p(e("tbody",null,[e("tr",null,[z,e("td",null,[n(u,{type:"text",maxlength:"40",name:"typeASecret",modelValue:l(t).typeASecret,"onUpdate:modelValue":a[1]||(a[1]=s=>l(t).typeASecret=s),autocomplete:"off",class:"w-full"},null,8,["modelValue"]),e("p",j,[o("只能包含字母、数字，长度不超过40。"),e("a",{href:"",onClick:a[2]||(a[2]=d(s=>l(t).generateTypeASecret(),["prevent"]))},"[随机生成]")])])]),e("tr",null,[K,e("td",null,[n(u,{type:"text",maxlength:"30",name:"typeASignParamName",value:"sign",modelValue:l(t).typeASignParamName,"onUpdate:modelValue":a[3]||(a[3]=s=>l(t).typeASignParamName=s),onInput:l(t).changeTypeASignParamName,class:"w-full"},null,8,["modelValue","onInput"])])]),e("tr",null,[Q,e("td",null,[n(y,null,{default:i(()=>[n(u,{type:"text",maxlength:"8",name:"typeALife",value:"30",style:{width:"7em"},modelValue:l(t).policy.params.life,"onUpdate:modelValue":a[4]||(a[4]=s=>l(t).policy.params.life=s)},null,8,["modelValue"]),n(h,null,{default:i(()=>[W]),_:1})]),_:1}),X])])],512),[[r,l(t).type=="typeA"]]),p(e("tbody",null,[e("tr",null,[Y,e("td",null,[n(u,{type:"text",maxlength:"40",name:"typeBSecret",modelValue:l(t).typeBSecret,"onUpdate:modelValue":a[5]||(a[5]=s=>l(t).typeBSecret=s),autocomplete:"off",class:"w-full"},null,8,["modelValue"]),e("p",Z,[o("只能包含字母、数字，长度不超过40。"),e("a",{href:"",onClick:a[6]||(a[6]=d(s=>l(t).generateTypeBSecret(),["prevent"]))},"[随机生成]")])])]),e("tr",null,[ee,e("td",null,[n(y,null,{default:i(()=>[n(u,{type:"text",maxlength:"8",name:"typeBLife",value:"30",style:{width:"7em"},modelValue:l(t).policy.params.life,"onUpdate:modelValue":a[7]||(a[7]=s=>l(t).policy.params.life=s)},null,8,["modelValue"]),n(h,null,{default:i(()=>[te]),_:1})]),_:1}),le])])],512),[[r,l(t).type=="typeB"]]),p(e("tbody",null,[e("tr",null,[ae,e("td",null,[n(u,{type:"text",maxlength:"40",name:"typeCSecret",modelValue:l(t).typeCSecret,"onUpdate:modelValue":a[8]||(a[8]=s=>l(t).typeCSecret=s),autocomplete:"off",class:"w-full"},null,8,["modelValue"]),e("p",se,[o("只能包含字母、数字，长度不超过40。"),e("a",{href:"",onClick:a[9]||(a[9]=d(s=>l(t).generateTypeCSecret(),["prevent"]))},"[随机生成]")])])]),e("tr",null,[ne,e("td",null,[n(y,null,{default:i(()=>[n(u,{type:"text",maxlength:"8",name:"typeCLife",value:"30",style:{width:"7em"},modelValue:l(t).policy.params.life,"onUpdate:modelValue":a[10]||(a[10]=s=>l(t).policy.params.life=s)},null,8,["modelValue"]),n(h,null,{default:i(()=>[oe]),_:1})]),_:1}),ie])])],512),[[r,l(t).type=="typeC"]]),p(e("tbody",null,[e("tr",null,[ue,e("td",null,[n(u,{type:"text",maxlength:"40",name:"typeDSecret",modelValue:l(t).typeDSecret,"onUpdate:modelValue":a[11]||(a[11]=s=>l(t).typeDSecret=s),autocomplete:"off",class:"w-full"},null,8,["modelValue"]),e("p",me,[o("只能包含字母、数字，长度不超过40。"),e("a",{href:"",onClick:a[12]||(a[12]=d(s=>l(t).generateTypeDSecret(),["prevent"]))},"[随机生成]")])])]),e("tr",null,[pe,e("td",null,[n(u,{type:"text",maxlength:"30",name:"typeDSignParamName",value:"sign",modelValue:l(t).typeDSignParamName,"onUpdate:modelValue":a[13]||(a[13]=s=>l(t).typeDSignParamName=s),onInput:l(t).changeTypeDSignParamName,class:"w-full"},null,8,["modelValue","onInput"])])]),e("tr",null,[re,e("td",null,[n(u,{type:"text",maxlength:"30",name:"typeDTimestampParamName",value:"t",modelValue:l(t).typeDTimestampParamName,"onUpdate:modelValue":a[14]||(a[14]=s=>l(t).typeDTimestampParamName=s),onInput:l(t).changeTypeDTimestampParamName,class:"w-full"},null,8,["modelValue","onInput"])])]),e("tr",null,[de,e("td",null,[n(y,null,{default:i(()=>[n(u,{type:"text",maxlength:"8",name:"typeDLife",value:"30",style:{width:"7em"},modelValue:l(t).policy.params.life,"onUpdate:modelValue":a[15]||(a[15]=s=>l(t).policy.params.life=s)},null,8,["modelValue"]),n(h,null,{default:i(()=>[ce]),_:1})]),_:1}),ye])])],512),[[r,l(t).type=="typeD"]]),p(e("tbody",null,[e("tr",null,[he,e("td",null,[n(b,{"v-users":l(t).policy.params.users},null,8,["v-users"])])]),e("tr",null,[e("td",fe,[e("a",{href:"",onClick:a[16]||(a[16]=d(s=>l(t).showMoreBasicAuthOptions(),["prevent"]))},[o("更多基本认证选项"),e("i",{class:T(["ui icon angle",{up:l(t).moreBasicAuthOptionsVisible,down:!l(t).moreBasicAuthOptionsVisible}])},null,2)])])]),p(e("tr",null,[_e,e("td",null,[n(u,{type:"text",name:"basicAuthRealm",value:"",maxlength:"100",class:"w-full",modelValue:l(t).policy.params.realm,"onUpdate:modelValue":a[17]||(a[17]=s=>l(t).policy.params.realm=s)},null,8,["modelValue"])])],512),[[r,l(t).moreBasicAuthOptionsVisible]]),p(e("tr",null,[Ve,e("td",null,[n(u,{type:"text",name:"basicAuthCharset",style:{width:"6em"},modelValue:l(t).policy.params.charset,"onUpdate:modelValue":a[18]||(a[18]=s=>l(t).policy.params.charset=s),maxlength:"50"},null,8,["modelValue"]),e("p",ge,[o("类似于 "),n(f,null,{default:i(()=>[o("utf-8")]),_:1}),o(" 。 ")])])],512),[[r,l(t).moreBasicAuthOptionsVisible]])],512),[[r,l(t).type=="basicAuth"]]),p(e("tbody",null,[e("tr",null,[Se,e("td",null,[n(u,{type:"text",name:"subRequestURL",maxlength:"1024",modelValue:l(t).policy.params.url,"onUpdate:modelValue":a[19]||(a[19]=s=>l(t).policy.params.url=s),class:"w-full"},null,8,["modelValue"]),De])]),e("tr",null,[Pe,e("td",null,[n(_,{name:"subRequestFollowRequest",value:1,modelValue:l(t).subRequestFollowRequest,"onUpdate:modelValue":a[20]||(a[20]=s=>l(t).subRequestFollowRequest=s)},{default:i(()=>[o("同当前请求一致")]),_:1},8,["modelValue"]),o("     "),n(_,{name:"subRequestFollowRequest",value:0,modelValue:l(t).subRequestFollowRequest,"onUpdate:modelValue":a[21]||(a[21]=s=>l(t).subRequestFollowRequest=s)},{default:i(()=>[o("自定义")]),_:1},8,["modelValue"]),p(e("div",xe,[n(v),n(A,{name:"subRequestMethod",modelValue:l(t).policy.params.method,"onUpdate:modelValue":a[22]||(a[22]=s=>l(t).policy.params.method=s)},{default:i(()=>[n(c,{value:""},{default:i(()=>[o("[请选择]")]),_:1}),n(c,{value:"POST"},{default:i(()=>[o("POST")]),_:1}),n(c,{value:"GET"},{default:i(()=>[o("GET")]),_:1}),n(c,{value:"PUT"},{default:i(()=>[o("PUT")]),_:1}),n(c,{value:"HEAD"},{default:i(()=>[o("HEAD")]),_:1})]),_:1},8,["modelValue"])],512),[[r,l(t).subRequestFollowRequest==0]])])])],512),[[r,l(t).type=="subRequest"]]),e("tbody",null,[e("tr",null,[e("td",Te,[n($)])])]),p(e("tbody",null,[e("tr",null,[ve,e("td",null,[n(L,{name:"exts","v-values":l(t).policy.params.exts},null,8,["v-values"]),e("p",Ne,[o("如果不为空，则表示只有这些扩展名的文件才需要鉴权；扩展名需要包含点符号（.），比如 "),n(f,null,{default:i(()=>[o(".png")]),_:1})])])]),e("tr",null,[e("td",null,[o("例外URL  "),n(g,{content:"对这些URL将不做任何限制。"})]),e("td",null,[n(V,{modelValue:l(t).policy.params.exceptURLPatterns,"onUpdate:modelValue":a[23]||(a[23]=s=>l(t).policy.params.exceptURLPatterns=s)},null,8,["modelValue"])])]),e("tr",null,[e("td",null,[o("限制URL  "),n(g,{content:"只对这些URL做限制。"})]),e("td",null,[n(V,{modelValue:l(t).policy.params.onlyURLPatterns,"onUpdate:modelValue":a[24]||(a[24]=s=>l(t).policy.params.onlyURLPatterns=s)},null,8,["modelValue"])])]),e("tr",null,[we,e("td",null,[n(B,{"v-domains":l(t).policy.params.domains},null,8,["v-domains"]),Ue])]),e("tr",null,[Re,e("td",null,[n(C,{name:"isOn",value:"1",modelValue:l(t).policy.isOn,"onUpdate:modelValue":a[25]||(a[25]=s=>l(t).policy.isOn=s)},null,8,["modelValue"])])])],512),[[r,l(t).moreOptionsVisible]])]),_:1}),n(q)]),_:1},8,["onSuccess"])]),_:1}))}};export{pt as default};
