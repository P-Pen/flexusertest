import{i as S,c as D}from"./app-DISTCiac.js";import{e as v}from"./app-DUeSaIYz.js";import{C as B}from"./app-BXvxi6wb.js";import{_ as w}from"./app-diI1Q6nu.js";import{C as k}from"./app-CnNkgeR8.js";import{C}from"./app-D2_aZ1I5.js";import{C as g}from"./app-DzOFJRH2.js";import{o as L,c as I,w as c,u,b as h,a,t as _,f as d,ae as z}from"./app-BYx064nO.js";import"./app-C9w-bzHc.js";import"./app-DyIe33QU.js";function N(){const{utils:e}=S(this);e.setEcharts(v),this.$delay(function(){let t=this;this.totalDailyStats=this.logDailyStats.map(function(o,l){return{day:o.day,count:t.logDailyStats[l].count+t.blockDailyStats[l].count+t.captchaDailyStats[l].count}});let n=this.processMaxUnit(this.totalDailyStats);this.reloadLineChart("daily-chart","规则分组",this.totalDailyStats,function(o){return o.day.substring(4,6)+"-"+o.day.substring(6)},function(o){return t.logDailyStats[o.dataIndex].day.substring(4,6)+"-"+t.logDailyStats[o.dataIndex].day.substring(6)+": 拦截: "+e.formatNumber(t.blockDailyStats[o.dataIndex].count)+", 验证码: "+e.formatNumber(t.captchaDailyStats[o.dataIndex].count)+", 记录: "+e.formatNumber(t.logDailyStats[o.dataIndex].count)},n);let i=this.processMaxUnit(this.groupStats),r=this.groupStats.$sum(function(o,l){return l.rawCount});this.reloadBarChart("group-chart","规则分组",this.groupStats,function(o){return o.group.name},function(o){let l="";return r>0&&(l=", 占比: "+Math.round(t.groupStats[o.dataIndex].rawCount*100*100/r)/100+"%"),t.groupStats[o.dataIndex].group.name+": "+e.formatNumber(t.groupStats[o.dataIndex].rawCount)+l},i),window.addEventListener("resize",function(){t.resizeChart("daily-chart"),t.resizeChart("group-chart")})}),this.reloadLineChart=function(t,n,i,r,o,l){let m=document.getElementById(t);if(m==null)return;let p=this,y={xAxis:{data:i.map(r),axisLabel:{color:e.chartLabelColor}},yAxis:{axisLabel:{formatter:function(s){return s+l},color:e.chartLabelColor}},tooltip:{show:!0,trigger:"item",formatter:o},grid:{left:40,top:10,right:20,bottom:20},series:[{name:n,type:"line",data:this.totalDailyStats.map(function(s,f){return p.totalDailyStats[f].count}),areaStyle:{},itemStyle:{color:e.DefaultChartColor}},{name:n,type:"line",data:this.logDailyStats.map(function(s){return s.count}),itemStyle:{color:"#879BD7"}},{name:n,type:"line",data:this.blockDailyStats.map(function(s){return s.count}),itemStyle:{color:"#F39494"}},{name:n,type:"line",data:this.captchaDailyStats.map(function(s){return s.count}),itemStyle:{color:"#FBD88A"}}],animation:!0};e.initChart(m,void 0,s=>{s.setOption(y),s.resize()})},this.reloadBarChart=function(t,n,i,r,o,l){let m=document.getElementById(t);m!=null&&e.initChart(m,void 0,p=>{let y=20,s=0;const f=e.xRotation(p,i.map(r));f!=null&&(y=f[0],s=f[1]);let b={xAxis:{data:i.map(r),axisLabel:{interval:0,color:e.chartLabelColor,rotate:s}},yAxis:{axisLabel:{formatter:function(x){return x+l},color:e.chartLabelColor}},tooltip:{show:!0,trigger:"item",formatter:o},grid:{left:40,top:10,right:20,bottom:y},series:[{name:n,type:"bar",data:i.map(function(x){return x.count}),itemStyle:{color:e.DefaultChartColor},barWidth:"10em"}],animation:!0};p.setOption(b),p.resize()})},this.resizeChart=function(t){let n=document.getElementById(t);n!=null&&e.initChart(n,void 0,i=>{i.resize()})},this.processMaxUnit=function(t){let n=t.$map(function(o,l){return l.count}).$max(),i=0,r="";return n>=1e3*1e3*1e3?(r="B",i=1e3*1e3*1e3):n>=1e3*1e3?(r="M",i=1e3*1e3):n>=1e3&&(r="K",i=1e3),t.forEach(function(o){o.rawCount=o.count,i>0&&(o.count/=i)}),r}}const A={class:"ui column"},E=a("h5",null,"今日拦截",-1),M={class:"value"},$={class:"ui column"},U=a("h5",null,"今日验证码验证",-1),V={class:"value"},F={class:"ui column"},R=a("h5",null,"今日记录",-1),O={class:"value"},W={class:"ui column"},K=a("h5",null,"本周拦截",-1),T={class:"value"},j={class:"ui column"},q=a("h5",null,"本月拦截",-1),G={class:"value"},H=a("span",{class:"color-span",style:{background:"#F39494"}},"拦截",-1),J=a("span",{class:"color-span",style:{background:"#FBD88A"}},"验证码",-1),P=a("span",{class:"color-span",style:{background:"#879BD7"}},"记录",-1),Q=a("div",{class:"chart-box",id:"daily-chart"},null,-1),X=a("div",{class:"chart-box",id:"group-chart"},null,-1),rt={__name:"waf",setup(e){const t=D(new N);return(n,i)=>(L(),I(B,{ctx:u(t),"has-tab":!0},{default:c(()=>[h(w,null,{default:c(()=>[a("div",A,[E,a("div",M,[a("span",null,_(u(t).countDailyBlock),1),d("次")])]),a("div",$,[U,a("div",V,[a("span",null,_(u(t).countDailyCaptcha),1),d("次")])]),a("div",F,[R,a("div",O,[a("span",null,_(u(t).countDailyLog),1),d("次")])]),a("div",W,[K,a("div",T,[a("span",null,_(u(t).countWeeklyBlock),1),d("次")])]),a("div",j,[q,a("div",G,[a("span",null,_(u(t).countMonthlyBlock),1),d("次")])])]),_:1}),h(k,null,{default:c(()=>[h(C,{cols:"1"},{header:c(()=>[d("近15日趋势 "),a("span",null,[a("span",{class:"color-span",style:z("background: "+u(t).$utils.DefaultChartColor)},"全部",4),H,J,P])]),default:c(()=>[h(g,null,{value:c(()=>[Q]),_:1})]),_:1}),h(C,{cols:"1"},{header:c(()=>[d("拦截类型分布")]),default:c(()=>[h(g,null,{value:c(()=>[X]),_:1})]),_:1})]),_:1})]),_:1},8,["ctx"]))}};export{rt as default};
