import{i as N,u as R,c as q}from"./app-DISTCiac.js";import{_ as L}from"./app-BAIc7wsg.js";import{_ as B}from"./app-C7gR9zYq.js";import{_ as P}from"./app-_N2IGwgj.js";import{_ as U}from"./app-57xpzLDR.js";import{r as h,J as A,o as c,g as v,a as e,u as t,b as l,w as _,c as O,h as b,d,e as m,F as D,D as J,f as a,t as W,i as V,L as G,bb as F}from"./app-BYx064nO.js";import{_ as w}from"./app--BlRpVz_.js";import{_ as H}from"./app-Bx5jiAm1.js";import{_ as z}from"./app-EcaQJ64L.js";import{P as E}from"./app-TBcc1obG.js";import{C as $}from"./app-IrmNFWm4.js";import{_ as C}from"./app-C5GVF480.js";import{T as M}from"./app-DNadG4GC.js";import{D as j}from"./app-D0jdtzyy.js";import"./app-BXvxi6wb.js";import"./app-C9w-bzHc.js";import"./app-DyIe33QU.js";import"./app-5V9SnxW6.js";import"./app-DOaxShSm.js";import"./app-DQhYsbJs.js";import"./app-BXiLqtxA.js";import"./app-CqvvE0jO.js";import"./app-CK9Tk_hc.js";import"./app-CAeEyuA3.js";import"./app-DoRtcMJm.js";import"./app-DPMEyUYH.js";import"./app-DR284fT9.js";import"./app-tUtHmy3n.js";import"./app-DYkSpHuE.js";function K(){N(this),this.success=this.$NotifyReloadSuccess("保存成功")}const Q=["value"],X=["value"],Y=e("td",{class:"title"},"启用Websocket",-1),Z=e("td",{class:"color-border"},[a("允许所有来源域"),e("em",null,"（Origin）")],-1),ee=e("p",{class:"comment"},"选中表示允许所有的来源域。",-1),te=e("td",{class:"color-border"},[a("允许的来源域列表"),e("em",null,"（Origin）")],-1),oe={key:0,class:"label-group"},se=["onClick"],ne=e("i",{class:"icon remove small"},null,-1),le=[ne],ie=e("p",{class:"comment"},"只允许在列表中的来源域名访问Websocket服务。",-1),ae=e("td",{class:"color-border"},"传递请求来源域",-1),re={class:"comment"},ue=e("td",{class:"color-border"},"指定传递的来源域",-1),ce={class:"comment"},de=e("td",null,[a("握手超时时间"),e("em",null,"（Handshake）")],-1),me={class:"ui fields inline"},fe={class:"ui field"},_e=e("div",{class:"ui field"}," 秒 ",-1),pe=e("p",{class:"comment"},"0表示使用默认的时间设置。",-1),ve={__name:"HTTPWebsocketBox",props:["v-websocket-ref","v-websocket-config","v-is-location","v-is-group"],setup(y){const r=R(),p=y,{websocketRef:u,websocketConfig:n,handshakeTimeoutCountString:g,advancedVisible:k}=function(){let s=p.vWebsocketRef;s==null&&(s={isPrior:!1,isOn:!1,websocketId:0});let o=p.vWebsocketConfig;return o==null?o={id:0,isOn:!1,handshakeTimeout:{count:30,unit:"second"},allowAllOrigins:!0,allowedOrigins:[],requestSameOrigin:!0,requestOrigin:""}:(o.handshakeTimeout==null&&(o.handshakeTimeout={count:30,unit:"second"}),o.allowedOrigins==null&&(o.allowedOrigins=[])),{websocketRef:h(s),websocketConfig:h(o),handshakeTimeoutCountString:h(o.handshakeTimeout.count.toString()),advancedVisible:h(!1)}}(),f=function(){return(!p.vIsLocation&&!p.vIsGroup||u.value.isPrior)&&u.value.isOn},S=function(s){k.value=s},T=function(){r.popup("/servers/server/settings/websocket/createOrigin",{callback:function(s){n.value.allowedOrigins.push(s.data.origin)}})},x=function(s){n.value.allowedOrigins.$remove(s)};return A(g,function(s){let o=parseInt(s);!isNaN(o)&&o>=0?n.value.handshakeTimeout.count=o:n.value.handshakeTimeout.count=0}),(s,o)=>(c(),v("div",null,[e("input",{type:"hidden",name:"websocketRefJSON",value:JSON.stringify(t(u))},null,8,Q),e("input",{type:"hidden",name:"websocketJSON",value:JSON.stringify(t(n))},null,8,X),l(j,null,{default:_(()=>[s.vIsLocation||s.vIsGroup?(c(),O(H,{key:0,"v-config":t(u)},null,8,["v-config"])):b("",!0),d(e("tbody",null,[e("tr",null,[Y,e("td",null,[l(w,{modelValue:t(u).isOn,"onUpdate:modelValue":o[0]||(o[0]=i=>t(u).isOn=i)},null,8,["modelValue"])])])],512),[[m,!s.vIsLocation&&!s.vIsGroup||t(u).isPrior]]),d(e("tbody",null,[e("tr",null,[Z,e("td",null,[l(w,{modelValue:t(n).allowAllOrigins,"onUpdate:modelValue":o[1]||(o[1]=i=>t(n).allowAllOrigins=i)},null,8,["modelValue"]),ee])])],512),[[m,f()]]),d(e("tbody",null,[e("tr",null,[te,e("td",null,[t(n).allowedOrigins.length>0?(c(),v("div",oe,[(c(!0),v(D,null,J(t(n).allowedOrigins,(i,I)=>(c(),O(M,{outlined:""},{default:_(()=>[a(W(i)+"  ",1),e("a",{href:"",title:"删除",onClick:V(ke=>x(I),["prevent"])},le,8,se)]),_:2},1024))),256)),l(G)])):b("",!0),l(E,{secondary:"",size:"small",type:"button",onClick:o[2]||(o[2]=V(i=>T(),["prevent"]))}),ie])])],512),[[m,f()&&!t(n).allowAllOrigins]]),d(l(z,{onChange:S},null,512),[[m,f()]]),d(e("tbody",null,[e("tr",null,[ae,e("td",null,[l(w,{modelValue:t(n).requestSameOrigin,"onUpdate:modelValue":o[3]||(o[3]=i=>t(n).requestSameOrigin=i)},null,8,["modelValue"]),e("p",re,[a("选中后，表示把接收到的请求中的 "),l($,null,{default:_(()=>[a("Origin")]),_:1}),a(" 字段传递到源站。 ")])])])],512),[[m,f()&&t(k)]]),d(e("tbody",null,[e("tr",null,[ue,e("td",null,[l(C,{type:"text",modelValue:t(n).requestOrigin,"onUpdate:modelValue":o[4]||(o[4]=i=>t(n).requestOrigin=i),maxlength:"200",class:"w-full"},null,8,["modelValue"]),e("p",ce,[a("指定向源站传递的 "),l($,null,{default:_(()=>[a("Origin")]),_:1}),a(" 字段值。 ")])])])],512),[[m,f()&&t(k)&&!t(n).requestSameOrigin]]),d(e("tbody",null,[e("tr",null,[de,e("td",null,[e("div",me,[e("div",fe,[l(C,{type:"text",maxlength:"10",modelValue:t(g),"onUpdate:modelValue":o[5]||(o[5]=i=>F(g)?g.value=i:null),style:{width:"6em"}},null,8,["modelValue"])]),_e]),pe])])],512),[[m,f()&&!1]])]),_:1})]))}},ge={key:0},he=["value"],be={key:1},Qe={__name:"index",setup(y){const r=q(new K);return(p,u)=>(c(),O(L,{ctx:t(r)},{default:_(()=>[t(r).featureIsOn?(c(),v("div",ge,[l(P,{action:"$",onSuccess:t(r).success},{default:_(()=>[e("input",{type:"hidden",name:"webId",value:t(r).webId},null,8,he),l(ve,{"v-websocket-ref":t(r).websocketRef,"v-websocket-config":t(r).websocketConfig},null,8,["v-websocket-ref","v-websocket-config"]),l(U,{class:"mt-4"})]),_:1},8,["onSuccess"])])):b("",!0),t(r).featureIsOn?b("",!0):(c(),v("div",be,[l(B)]))]),_:1},8,["ctx"]))}};export{Qe as default};
